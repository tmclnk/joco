{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" src/simd/archsimd/internal/simd_test/simd_test.go | 77 +++++++++++++++++++++++\n 1 file changed, 77 insertions(+)\n\ndiff --git a/src/simd/archsimd/internal/simd_test/simd_test.go b/src/simd/archsimd/internal/simd_test/simd_test.go\nindex 76b296c9..671ec05e 100644\n--- a/src/simd/archsimd/internal/simd_test/simd_test.go\n+++ b/src/simd/archsimd/internal/simd_test/simd_test.go\n@@ -1296,3 +1296,80 @@ func TestAddSubPairs(t *testing.T) {\n \t\ttestFloat64x4Binary(t, archsimd.Float64x4.SubPairsGrouped, subPairsGroupedSlice[float64])\n \t}\n }\n+\n+func convConcatSlice[T, U number](a, b []T, conv func(T) U) []U {\n+\tr := make([]U, len(a)+len(b))\n+\tfor i, v := range a {\n+\t\tr[i] = conv(v)\n+\t}\n+\tfor i, v := range b {\n+\t\tr[len(a)+i] = conv(v)\n+\t}\n+\treturn r\n+}\n+\n+func convConcatGroupedSlice[T, U number](a, b []T, conv func(T) U) []U {\n+\tgroup := int(128 / unsafe.Sizeof(a[0]))\n+\tr := make([]U, 0, len(a)+len(b))\n+\tfor i := 0; i < len(a)/group; i++ {\n+\t\tr = append(r, convConcatSlice(a[i*group:(i+1)*group], b[i*group:(i+1)*group], conv)...)\n+\t}\n+\treturn r\n+}\n+\n+func TestSaturateConcat(t *testing.T) {\n+\t// Int32x4.SaturateToInt16Concat\n+\tforSlicePair(t, int32s, 4, func(x, y []int32) bool {\n+\t\ta, b := archsimd.LoadInt32x4Slice(x), archsimd.LoadInt32x4Slice(y)\n+\t\tvar out [8]int16\n+\t\ta.SaturateToInt16Concat(b).Store(&out)\n+\t\twant := convConcatSlice(x, y, satToInt16)\n+\t\treturn checkSlicesLogInput(t, out[:], want, 0, func() { t.Logf(\"x=%v, y=%v\", x, y) })\n+\t})\n+\t// Int32x4.SaturateToUint16Concat\n+\tforSlicePair(t, int32s, 4, func(x, y []int32) bool {\n+\t\ta, b := archsimd.LoadInt32x4Slice(x), archsimd.LoadInt32x4Slice(y)\n+\t\tvar out [8]uint16\n+\t\ta.SaturateToUint16Concat(b).Store(&out)\n+\t\twant := convConcatSlice(x, y, satToUint16)\n+\t\treturn checkSlicesLogInput(t, out[:], want, 0, func() { t.Logf(\"x=%v, y=%v\", x, y) })\n+\t})\n+\n+\tif archsimd.X86.AVX2() {\n+\t\t// Int32x8.SaturateToInt16ConcatGrouped\n+\t\tforSlicePair(t, int32s, 8, func(x, y []int32) bool {\n+\t\t\ta, b := archsimd.LoadInt32x8Slice(x), archsimd.LoadInt32x8Slice(y)\n+\t\t\tvar out [16]int16\n+\t\t\ta.SaturateToInt16ConcatGrouped(b).Store(&out)\n+\t\t\twant := convConcatGroupedSlice(x, y, satToInt16)\n+\t\t\treturn checkSlicesLogInput(t, out[:], want, 0, func() { t.Logf(\"x=%v, y=%v\", x, y) })\n+\t\t})\n+\t\t// Int32x8.SaturateToUint16ConcatGrouped\n+\t\tforSlicePair(t, int32s, 8, func(x, y []int32) bool {\n+\t\t\ta, b := archsimd.LoadInt32x8Slice(x), archsimd.LoadInt32x8Slice(y)\n+\t\t\tvar out [16]uint16\n+\t\t\ta.SaturateToUint16ConcatGrouped(b).Store(&out)\n+\t\t\twant := convConcatGroupedSlice(x, y, satToUint16)\n+\t\t\treturn checkSlicesLogInput(t, out[:], want, 0, func() { t.Logf(\"x=%v, y=%v\", x, y) })\n+\t\t})\n+\t}\n+\n+\tif archsimd.X86.AVX512() {\n+\t\t// Int32x16.SaturateToInt16ConcatGrouped\n+\t\tforSlicePair(t, int32s, 16, func(x, y []int32) bool {\n+\t\t\ta, b := archsimd.LoadInt32x16Slice(x), archsimd.LoadInt32x16Slice(y)\n+\t\t\tvar out [32]int16\n+\t\t\ta.SaturateToInt16ConcatGrouped(b).Store(&out)\n+\t\t\twant := convConcatGroupedSlice(x, y, satToInt16)\n+\t\t\treturn checkSlicesLogInput(t, out[:], want, 0, func() { t.Logf(\"x=%v, y=%v\", x, y) })\n+\t\t})\n+\t\t// Int32x16.SaturateToUint16ConcatGrouped\n+\t\tforSlicePair(t, int32s, 16, func(x, y []int32) bool {\n+\t\t\ta, b := archsimd.LoadInt32x16Slice(x), archsimd.LoadInt32x16Slice(y)\n+\t\t\tvar out [32]uint16\n+\t\t\ta.SaturateToUint16ConcatGrouped(b).Store(&out)\n+\t\t\twant := convConcatGroupedSlice(x, y, satToUint16)\n+\t\t\treturn checkSlicesLogInput(t, out[:], want, 0, func() { t.Logf(\"x=%v, y=%v\", x, y) })\n+\t\t})\n+\t}\n+}","output":"test(simd): add saturate concat tests","metadata":{"id":"go-06eff0f7","repository":"go","commit_hash":"06eff0f7c3027a78088d45efdaec8ac3ed636481"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" test/codegen/comparisons.go | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a/test/codegen/comparisons.go b/test/codegen/comparisons.go\nindex bcce21e4..0b550adc 100644\n--- a/test/codegen/comparisons.go\n+++ b/test/codegen/comparisons.go\n@@ -660,13 +660,13 @@ func equalVarString8(a string) bool {\n \treturn a[:8] == b\n }\n \n-func equalVarStringNoSpill(a,b string) bool {\n+func equalVarStringNoSpill(a, b string) bool {\n \ts := string(\"ZZZZZZZZZ\")\n \t// arm64:\".*memequal\"\n \tmemeq1 := a[:9] == s\n \t// arm64:-\".*\"\n \tmemeq2 := s == a[:9]\n-\t// arm64:-\"MOVB\\tR0,.*SP\",\".*memequal\"\n+\t// arm64:-\"MOVB R0,.*SP\",\".*memequal\"\n \tmemeq3 := s == b[:9]\n \treturn memeq1 && memeq2 && memeq3\n }","output":"test: fix formatting in codegen comparisons","metadata":{"id":"go-df4e08ac","repository":"go","commit_hash":"df4e08ac65e94041367785783ec1482e8bed2397"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" CHANGELOG.md | 18 ++++++++++++++++++\n 1 file changed, 18 insertions(+)\n\ndiff --git a/CHANGELOG.md b/CHANGELOG.md\nindex 85d8f54..5953faf 100644\n--- a/CHANGELOG.md\n+++ b/CHANGELOG.md\n@@ -1,3 +1,9 @@\n+## 19.2.1 (Dec 3, 2025)\n+\n+### React Server Components\n+\n+- Bring React Server Component fixes to Server Actions (@sebmarkbage [#35277](https://github.com/facebook/react/pull/35277))\n+\n ## 19.2.0 (October 1st, 2025)\n \n Below is a list of all new features, APIs, and bug fixes.\n@@ -71,6 +77,12 @@ Read the [React 19.2 release post](https://react.dev/blog/2025/10/01/react-19-2)\n \n - [createContainer](https://github.com/facebook/react/blob/v19.2.0/packages/react-reconciler/src/ReactFiberReconciler.js#L255-L261) and [createHydrationContainer](https://github.com/facebook/react/blob/v19.2.0/packages/react-reconciler/src/ReactFiberReconciler.js#L305-L312) had their parameter order adjusted after `on*` handlers to account for upcoming experimental APIs\n \n+## 19.1.2 (Dec 3, 2025)\n+\n+### React Server Components\n+\n+- Bring React Server Component fixes to Server Actions (@sebmarkbage [#35277](https://github.com/facebook/react/pull/35277))\n+\n ## 19.1.1 (July 28, 2025)\n \n ### React\n@@ -123,6 +135,12 @@ An Owner Stack is a string representing the components that are directly respons\n * Exposed `registerServerReference` in client builds to handle server references in different environments. [#32534](https://github.com/facebook/react/pull/32534)\n * Added react-server-dom-parcel package which integrates Server Components with the [Parcel bundler](https://parceljs.org/) [#31725](https://github.com/facebook/react/pull/31725), [#32132](https://github.com/facebook/react/pull/32132), [#31799](https://github.com/facebook/react/pull/31799), [#32294](https://github.com/facebook/react/pull/32294), [#31741](https://github.com/facebook/react/pull/31741)\n \n+## 19.0.1 (Dec 3, 2025)\n+\n+### React Server Components\n+\n+- Bring React Server Component fixes to Server Actions (@sebmarkbage [#35277](https://github.com/facebook/react/pull/35277))\n+\n ## 19.0.0 (December 5, 2024)\n \n Below is a list of all new features, APIs, deprecations, and breaking changes. Read [React 19 release post](https://react.dev/blog/2024/04/25/react-19) and [React 19 upgrade guide](https://react.dev/blog/2024/04/25/react-19-upgrade-guide) for more information.","output":"docs: update changelog with patch releases","metadata":{"id":"react-0526c799","repository":"react","commit_hash":"0526c799d4df2815aed73912bfbd26fc0102ffc3"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" compiler/rustc_middle/src/mir/syntax.rs            | 25 +++---\n .../src/builder/matches/match_pair.rs              | 93 ++++++++++++----------\n 2 files changed, 67 insertions(+), 51 deletions(-)","output":"refactor(mir): restructure match pair builder","metadata":{"id":"rust-69f0a498","repository":"rust","commit_hash":"69f0a498ba504c42a3dedf0431c2b2b40c4e86f4"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" .../src/HIR/Environment.ts                         |  6 +++\n .../src/Validation/ValidateNoSetStateInRender.ts   | 48 +++++++++++++++-------\n ...alid-setState-in-render-unbound-state.expect.md |  6 ++-\n ...tstate-unconditional-with-keyed-state.expect.md | 44 ++++++++++++++++++++\n ...alid-setstate-unconditional-with-keyed-state.js | 14 +++++++\n ...ional-set-state-hook-return-in-render.expect.md | 12 ++++--\n ...lid-unconditional-set-state-in-render.expect.md | 12 ++++--\n ...nconditional-set-state-prop-in-render.expect.md | 12 ++++--\n ...-set-state-in-render-after-loop-break.expect.md |  6 ++-\n ...tional-set-state-in-render-after-loop.expect.md |  6 ++-\n ...l-set-state-in-render-with-loop-throw.expect.md |  6 ++-\n .../error.unconditional-set-state-lambda.expect.md |  6 ++-\n ...set-state-nested-function-expressions.expect.md |  6 ++-\n 13 files changed, 146 insertions(+), 38 deletions(-)\n\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts b/compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts\nindex fc5ba40..17dd53a 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts\n+++ b/compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts\n@@ -318,6 +318,12 @@ export const EnvironmentConfigSchema = z.object({\n    */\n   validateNoSetStateInRender: z.boolean().default(true),\n \n+  /**\n+   * When enabled, changes the behavior of validateNoSetStateInRender to recommend\n+   * using useKeyedState instead of the manual pattern for resetting state.\n+   */\n+  enableUseKeyedState: z.boolean().default(false),\n+\n   /**\n    * Validates that setState is not called synchronously within an effect (useEffect and friends).\n    * Scheduling a setState (with an event listener, subscription, etc) is valid.\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoSetStateInRender.ts b/compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoSetStateInRender.ts\nindex a1a05b2..e0d34d5 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoSetStateInRender.ts\n+++ b/compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoSetStateInRender.ts\n@@ -155,20 +155,40 @@ function validateNoSetStateInRenderImpl(\n                 }),\n               );\n             } else if (unconditionalBlocks.has(block.id)) {\n-              errors.pushDiagnostic(\n-                CompilerDiagnostic.create({\n-                  category: ErrorCategory.RenderSetState,\n-                  reason:\n-                    'Calling setState during render may trigger an infinite loop',\n-                  description:\n-                    'Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState)',\n-                  suggestions: null,\n-                }).withDetails({\n-                  kind: 'error',\n-                  loc: callee.loc,\n-                  message: 'Found setState() in render',\n-                }),\n-              );\n+              const enableUseKeyedState = fn.env.config.enableUseKeyedState;\n+              if (enableUseKeyedState) {\n+                errors.pushDiagnostic(\n+                  CompilerDiagnostic.create({\n+                    category: ErrorCategory.RenderSetState,\n+                    reason: 'Cannot call setState during render',\n+                    description:\n+                      'Calling setState during render may trigger an infinite loop.\\n' +\n+                      '* To reset state when other state/props change, use `const [state, setState] = useKeyedState(initialState, key)` to reset `state` when `key` changes.\\n' +\n+                      '* To derive data from other state/props, compute the derived data during render without using state',\n+                    suggestions: null,\n+                  }).withDetails({\n+                    kind: 'error',\n+                    loc: callee.loc,\n+                    message: 'Found setState() in render',\n+                  }),\n+                );\n+              } else {\n+                errors.pushDiagnostic(\n+                  CompilerDiagnostic.create({\n+                    category: ErrorCategory.RenderSetState,\n+                    reason: 'Cannot call setState during render',\n+                    description:\n+                      'Calling setState during render may trigger an infinite loop.\\n' +\n+                      '* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\\n' +\n+                      '* To derive data from other state/props, compute the derived data during render without using state',\n+                    suggestions: null,\n+                  }).withDetails({\n+                    kind: 'error',\n+                    loc: callee.loc,\n+                    message: 'Found setState() in render',\n+                  }),\n+                );\n+              }\n             }\n           }\n           break;\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setState-in-render-unbound-state.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setState-in-render-unbound-state.expect.md\nindex 423076c..43ae7d0 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setState-in-render-unbound-state.expect.md\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setState-in-render-unbound-state.expect.md\n@@ -24,9 +24,11 @@ export const FIXTURE_ENTRYPOINT = {\n ```\n Found 1 error:\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.invalid-setState-in-render-unbound-state.ts:5:2\n   3 |   // infer the type of destructured properties after a hole in the array\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setstate-unconditional-with-keyed-state.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setstate-unconditional-with-keyed-state.expect.md\nnew file mode 100644\nindex 0000000..7caed10\n--- /dev/null\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setstate-unconditional-with-keyed-state.expect.md\n@@ -0,0 +1,44 @@\n+\n+## Input\n+\n+```javascript\n+// @validateNoSetStateInRender @enableUseKeyedState\n+import {useState} from 'react';\n+\n+function Component() {\n+  const [total, setTotal] = useState(0);\n+  setTotal(42);\n+  return total;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [],\n+  isComponent: true,\n+};\n+\n+```\n+\n+\n+## Error\n+\n+```\n+Found 1 error:\n+\n+Error: Cannot call setState during render\n+\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, use `const [state, setState] = useKeyedState(initialState, key)` to reset `state` when `key` changes.\n+* To derive data from other state/props, compute the derived data during render without using state.\n+\n+error.invalid-setstate-unconditional-with-keyed-state.ts:6:2\n+  4 | function Component() {\n+  5 |   const [total, setTotal] = useState(0);\n+> 6 |   setTotal(42);\n+    |   ^^^^^^^^ Found setState() in render\n+  7 |   return total;\n+  8 | }\n+  9 |\n+```\n+          \n+      \n\\ No newline at end of file\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setstate-unconditional-with-keyed-state.js b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setstate-unconditional-with-keyed-state.js\nnew file mode 100644\nindex 0000000..46393b5\n--- /dev/null\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-setstate-unconditional-with-keyed-state.js\n@@ -0,0 +1,14 @@\n+// @validateNoSetStateInRender @enableUseKeyedState\n+import {useState} from 'react';\n+\n+function Component() {\n+  const [total, setTotal] = useState(0);\n+  setTotal(42);\n+  return total;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [],\n+  isComponent: true,\n+};\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-hook-return-in-render.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-hook-return-in-render.expect.md\nindex fcd2f7c..cb52054 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-hook-return-in-render.expect.md\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-hook-return-in-render.expect.md\n@@ -25,9 +25,11 @@ function useCustomState(init) {\n ```\n Found 2 errors:\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.invalid-unconditional-set-state-hook-return-in-render.ts:6:2\n   4 |   const aliased = setState;\n@@ -38,9 +40,11 @@ error.invalid-unconditional-set-state-hook-return-in-render.ts:6:2\n   8 |\n   9 |   return state;\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.invalid-unconditional-set-state-hook-return-in-render.ts:7:2\n    5 |\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-in-render.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-in-render.expect.md\nindex 78deea8..9155951 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-in-render.expect.md\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-in-render.expect.md\n@@ -21,9 +21,11 @@ function Component(props) {\n ```\n Found 2 errors:\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.invalid-unconditional-set-state-in-render.ts:6:2\n   4 |   const aliased = setX;\n@@ -34,9 +36,11 @@ error.invalid-unconditional-set-state-in-render.ts:6:2\n   8 |\n   9 |   return x;\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.invalid-unconditional-set-state-in-render.ts:7:2\n    5 |\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-prop-in-render.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-prop-in-render.expect.md\nindex 1a3eb1b..8c46cba 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-prop-in-render.expect.md\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-unconditional-set-state-prop-in-render.expect.md\n@@ -20,9 +20,11 @@ function Component({setX}) {\n ```\n Found 2 errors:\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.invalid-unconditional-set-state-prop-in-render.ts:5:2\n   3 |   const aliased = setX;\n@@ -33,9 +35,11 @@ error.invalid-unconditional-set-state-prop-in-render.ts:5:2\n   7 |\n   8 |   return x;\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.invalid-unconditional-set-state-prop-in-render.ts:6:2\n   4 |\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-after-loop-break.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-after-loop-break.expect.md\nindex 8ccb4f2..ad39cbc 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-after-loop-break.expect.md\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-after-loop-break.expect.md\n@@ -24,9 +24,11 @@ function Component(props) {\n ```\n Found 1 error:\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.unconditional-set-state-in-render-after-loop-break.ts:11:2\n    9 |     }\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-after-loop.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-after-loop.expect.md\nindex df805b4..066c185 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-after-loop.expect.md\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-after-loop.expect.md\n@@ -19,9 +19,11 @@ function Component(props) {\n ```\n Found 1 error:\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.unconditional-set-state-in-render-after-loop.ts:6:2\n   4 |   for (const _ of props) {\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-with-loop-throw.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-with-loop-throw.expect.md\nindex 313b2ed..82d7cfb 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-with-loop-throw.expect.md\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-in-render-with-loop-throw.expect.md\n@@ -24,9 +24,11 @@ function Component(props) {\n ```\n Found 1 error:\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.unconditional-set-state-in-render-with-loop-throw.ts:11:2\n    9 |     }\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-lambda.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-lambda.expect.md\nindex 1c89b5c..1ebd422 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-lambda.expect.md\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-lambda.expect.md\n@@ -22,9 +22,11 @@ function Component(props) {\n ```\n Found 1 error:\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.unconditional-set-state-lambda.ts:8:2\n    6 |     setX(1);\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-nested-function-expressions.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-nested-function-expressions.expect.md\nindex fceed8b..4736e66 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-nested-function-expressions.expect.md\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.unconditional-set-state-nested-function-expressions.expect.md\n@@ -30,9 +30,11 @@ function Component(props) {\n ```\n Found 1 error:\n \n-Error: Calling setState during render may trigger an infinite loop\n+Error: Cannot call setState during render\n \n-Calling setState during render will trigger another render, and can lead to infinite loops. (https://react.dev/reference/react/useState).\n+Calling setState during render may trigger an infinite loop.\n+* To reset state when other state/props change, store the previous value in state and update conditionally: https://react.dev/reference/react/useState#storing-information-from-previous-renders\n+* To derive data from other state/props, compute the derived data during render without using state.\n \n error.unconditional-set-state-nested-function-expressions.ts:16:2\n   14 |     bar();","output":"fix(compiler): improve setState-in-render error messages","metadata":{"id":"react-f99241b2","repository":"react","commit_hash":"f99241b2e6cec825dfbdbb878755f12e1f510ca9"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" compiler/rustc_hir_typeck/src/pat.rs               | 13 +--\n compiler/rustc_lint_defs/src/builtin.rs            |  2 +-\n compiler/rustc_middle/src/mir/syntax.rs            | 25 +++---\n compiler/rustc_middle/src/thir.rs                  | 14 +---\n compiler/rustc_middle/src/thir/visit.rs            |  8 +-\n compiler/rustc_mir_build/src/builder/block.rs      | 13 +--\n .../src/builder/expr/as_constant.rs                |  2 +-\n .../rustc_mir_build/src/builder/expr/as_operand.rs |  9 ++-\n .../rustc_mir_build/src/builder/expr/as_place.rs   |  5 +-\n .../rustc_mir_build/src/builder/expr/as_rvalue.rs  |  9 ++-\n .../rustc_mir_build/src/builder/expr/as_temp.rs    | 12 +--\n compiler/rustc_mir_build/src/builder/expr/into.rs  |  5 +-\n compiler/rustc_mir_build/src/builder/expr/stmt.rs  | 10 +--\n .../src/builder/matches/match_pair.rs              | 93 ++++++++++++----------\n .../rustc_mir_build/src/builder/matches/mod.rs     |  8 +-\n compiler/rustc_mir_build/src/builder/mod.rs        |  4 +-\n compiler/rustc_mir_build/src/builder/scope.rs      | 10 ++-\n compiler/rustc_mir_build/src/check_unsafety.rs     |  2 +-\n compiler/rustc_mir_build/src/thir/cx/block.rs      |  2 +-\n compiler/rustc_mir_build/src/thir/cx/expr.rs       |  4 +-\n .../src/thir/pattern/check_match.rs                | 66 +++++++--------\n compiler/rustc_mir_build/src/thir/print.rs         | 12 +--\n tests/ui/imports/ambiguous-10.rs                   |  4 +-\n tests/ui/imports/ambiguous-10.stderr               | 10 +--\n tests/ui/imports/ambiguous-12.rs                   |  4 +-\n tests/ui/imports/ambiguous-12.stderr               | 10 +--\n tests/ui/imports/ambiguous-13.rs                   |  4 +-\n tests/ui/imports/ambiguous-13.stderr               | 10 +--\n tests/ui/imports/ambiguous-14.rs                   |  4 +-\n tests/ui/imports/ambiguous-14.stderr               | 10 +--\n tests/ui/imports/ambiguous-15.rs                   |  4 +-\n tests/ui/imports/ambiguous-15.stderr               | 10 +--\n tests/ui/imports/ambiguous-16.rs                   |  4 +-\n tests/ui/imports/ambiguous-16.stderr               | 10 +--\n tests/ui/imports/ambiguous-17.rs                   |  4 +-\n tests/ui/imports/ambiguous-17.stderr               | 10 +--\n tests/ui/imports/ambiguous-2.rs                    |  4 +-\n tests/ui/imports/ambiguous-2.stderr                | 10 +--\n tests/ui/imports/ambiguous-3.rs                    |  4 +-\n tests/ui/imports/ambiguous-3.stderr                | 10 +--\n tests/ui/imports/ambiguous-4.rs                    |  4 +-\n tests/ui/imports/ambiguous-4.stderr                | 10 +--\n tests/ui/imports/ambiguous-5.rs                    |  4 +-\n tests/ui/imports/ambiguous-5.stderr                | 10 +--\n tests/ui/imports/ambiguous-6.rs                    |  4 +-\n tests/ui/imports/ambiguous-6.stderr                | 10 +--\n tests/ui/imports/ambiguous-9.rs                    |  6 +-\n tests/ui/imports/ambiguous-9.stderr                | 16 ++--\n tests/ui/imports/ambiguous-panic-globvsglob.rs     |  4 +-\n tests/ui/imports/ambiguous-panic-globvsglob.stderr | 10 +--\n tests/ui/imports/duplicate.rs                      |  2 +-\n tests/ui/imports/duplicate.stderr                  | 10 +--\n tests/ui/imports/glob-conflict-cross-crate-1.rs    |  6 +-\n .../ui/imports/glob-conflict-cross-crate-1.stderr  | 16 ++--\n tests/ui/imports/glob-conflict-cross-crate-2.rs    |  4 +-\n .../ui/imports/glob-conflict-cross-crate-2.stderr  | 10 +--\n tests/ui/imports/glob-conflict-cross-crate-3.rs    |  6 +-\n .../ui/imports/glob-conflict-cross-crate-3.stderr  | 16 ++--\n tests/ui/imports/issue-114682-2.rs                 |  6 +-\n tests/ui/imports/issue-114682-2.stderr             | 16 ++--\n tests/ui/imports/issue-114682-4.rs                 |  2 +-\n tests/ui/imports/issue-114682-4.stderr             | 10 +--\n tests/ui/imports/issue-114682-5.rs                 |  2 +-\n tests/ui/imports/issue-114682-5.stderr             | 10 +--\n tests/ui/imports/issue-114682-6.rs                 |  4 +-\n tests/ui/imports/issue-114682-6.stderr             | 10 +--\n tests/ui/imports/overwrite-different-ambig-2.rs    |  4 +-\n .../ui/imports/overwrite-different-ambig-2.stderr  | 22 ++---\n tests/ui/imports/unresolved-seg-after-ambiguous.rs |  2 +-\n .../imports/unresolved-seg-after-ambiguous.stderr  | 10 +--\n tests/ui/pattern/type_mismatch.rs                  | 63 ++++++++++++++-\n tests/ui/pattern/type_mismatch.stderr              | 61 +++++++++++++-\n tests/ui/thir-print/c-variadic.stdout              |  2 +-\n tests/ui/thir-print/offset_of.stdout               | 76 +++++++++---------\n tests/ui/thir-print/thir-flat-const-variant.stdout | 36 +++------\n tests/ui/thir-print/thir-flat.stdout               |  4 +-\n tests/ui/thir-print/thir-tree-loop-match.stdout    | 24 +++---\n tests/ui/thir-print/thir-tree-match.stdout         | 20 ++---\n tests/ui/thir-print/thir-tree.stdout               |  2 +-\n tests/ui/unpretty/box.stdout                       |  8 +-\n 80 files changed, 557 insertions(+), 439 deletions(-)","output":"refactor: restructure thir pattern matching and fix import ambiguity","metadata":{"id":"rust-7704328b","repository":"rust","commit_hash":"7704328ba5ae8d6ce0ac303c9d5a1a1605906766"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" .../__tests__/components/KeepAlive.spec.ts         | 49 ++++++++++++++++++++++\n packages/runtime-core/src/components/KeepAlive.ts  |  8 +++-\n 2 files changed, 56 insertions(+), 1 deletion(-)\n\ndiff --git a/packages/runtime-core/__tests__/components/KeepAlive.spec.ts b/packages/runtime-core/__tests__/components/KeepAlive.spec.ts\nindex 1e4176b..3309ca0 100644\n--- a/packages/runtime-core/__tests__/components/KeepAlive.spec.ts\n+++ b/packages/runtime-core/__tests__/components/KeepAlive.spec.ts\n@@ -1173,4 +1173,53 @@ describe('KeepAlive', () => {\n     expect(deactivatedHome).toHaveBeenCalledTimes(0)\n     expect(unmountedHome).toHaveBeenCalledTimes(1)\n   })\n+\n+  test('should work with async component when update `include` props', async () => {\n+    let resolve: (comp: Component) => void\n+    const AsyncComp = defineAsyncComponent(\n+      () =>\n+        new Promise(r => {\n+          resolve = r as any\n+        }),\n+    )\n+\n+    const toggle = ref(true)\n+    const instanceRef = ref<any>(null)\n+    const keepaliveInclude = ref(['Foo'])\n+    const App = {\n+      render: () => {\n+        return h(KeepAlive, { include: keepaliveInclude.value }, () =>\n+          toggle.value ? h(AsyncComp, { ref: instanceRef }) : null,\n+        )\n+      },\n+    }\n+\n+    render(h(App), root)\n+    // async component has not been resolved\n+    expect(serializeInner(root)).toBe('<!---->')\n+\n+    resolve!({\n+      name: 'Foo',\n+      data: () => ({ count: 0 }),\n+      render() {\n+        return h('p', this.count)\n+      },\n+    })\n+\n+    await timeout()\n+    // resolved\n+    expect(serializeInner(root)).toBe('<p>0</p>')\n+\n+    // change state + toggle out + update `include` props\n+    instanceRef.value.count++\n+    toggle.value = false\n+    keepaliveInclude.value = ['Foo']\n+    await nextTick()\n+    expect(serializeInner(root)).toBe('<!---->')\n+\n+    // toggle in, state should be maintained\n+    toggle.value = true\n+    await nextTick()\n+    expect(serializeInner(root)).toBe('<p>1</p>')\n+  })\n })\ndiff --git a/packages/runtime-core/src/components/KeepAlive.ts b/packages/runtime-core/src/components/KeepAlive.ts\nindex f2b7bdf..55eaf86 100644\n--- a/packages/runtime-core/src/components/KeepAlive.ts\n+++ b/packages/runtime-core/src/components/KeepAlive.ts\n@@ -202,7 +202,13 @@ const KeepAliveImpl: ComponentOptions = {\n \n     function pruneCache(filter: (name: string) => boolean) {\n       cache.forEach((vnode, key) => {\n-        const name = getComponentName(vnode.type as ConcreteComponent)\n+        // for async components, name check should be based in its loaded\n+        // inner component if available\n+        const name = getComponentName(\n+          isAsyncWrapper(vnode)\n+            ? (vnode.type as ComponentOptions).__asyncResolved || {}\n+            : (vnode.type as ConcreteComponent),\n+        )\n         if (name && !filter(name)) {\n           pruneCacheEntry(key)\n         }","output":"fix(keep-alive): handle async component name in include/exclude matching","metadata":{"id":"vue-dfe667c8","repository":"vue","commit_hash":"dfe667c8567d48167c250062483d2d2cfc7bdc03"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" docs/en/docs/release-notes.md | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a/docs/en/docs/release-notes.md b/docs/en/docs/release-notes.md\nindex 08bc292..5498039 100644\n--- a/docs/en/docs/release-notes.md\n+++ b/docs/en/docs/release-notes.md\n@@ -13,6 +13,7 @@ hide:\n \n ### Translations\n \n+* üåê Update translations for es (update-outdated). PR [#14686](https://github.com/fastapi/fastapi/pull/14686) by [@tiangolo](https://github.com/tiangolo).\n * üîß Add LLM prompt file for Turkish, generated from the existing translations. PR [#14547](https://github.com/fastapi/fastapi/pull/14547) by [@tiangolo](https://github.com/tiangolo).\n * üîß Add LLM prompt file for Traditional Chinese, generated from the existing translations. PR [#14550](https://github.com/fastapi/fastapi/pull/14550) by [@tiangolo](https://github.com/tiangolo).\n * üîß Add LLM prompt file for Simplified Chinese, generated from the existing translations. PR [#14549](https://github.com/fastapi/fastapi/pull/14549) by [@tiangolo](https://github.com/tiangolo).","output":"docs: update release notes with spanish translation","metadata":{"id":"fastapi-f03a1502","repository":"fastapi","commit_hash":"f03a1502a0a72d466cf4b08c900b886bdda146c8"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commits format: type(scope): description\n\nValid types: feat, fix, docs, style, refactor, perf, test, build, ci, chore\n\nRules:\n- Keep the subject line under 72 characters\n- Start description with lowercase\n- Do not end with a period\n- Be concise and specific","input":" packages/compiler/src/expression_parser/ast.ts | 32 ++++++++++++++++++++++++--\n 1 file changed, 30 insertions(+), 2 deletions(-)\n\ndiff --git a/packages/compiler/src/expression_parser/ast.ts b/packages/compiler/src/expression_parser/ast.ts\nindex 2f6fcc18..099c4059 100644\n--- a/packages/compiler/src/expression_parser/ast.ts\n+++ b/packages/compiler/src/expression_parser/ast.ts\n@@ -268,11 +268,39 @@ export class Interpolation extends AST {\n   }\n }\n \n+type AssignmentOperation \u003d \u0027\u003d\u0027 | \u0027+\u003d\u0027 | \u0027-\u003d\u0027 | \u0027*\u003d\u0027 | \u0027/\u003d\u0027 | \u0027%\u003d\u0027 | \u0027**\u003d\u0027 | \u0027\u0026\u0026\u003d\u0027 | \u0027||\u003d\u0027 | \u0027??\u003d\u0027;\n+type BinaryOperation \u003d\n+  | AssignmentOperation\n+  // Logical\n+  | \u0027\u0026\u0026\u0027\n+  | \u0027||\u0027\n+  | \u0027??\u0027\n+  // Equality\n+  | \u0027\u003d\u003d\u0027\n+  | \u0027!\u003d\u0027\n+  | \u0027\u003d\u003d\u003d\u0027\n+  | \u0027!\u003d\u003d\u0027\n+  // Relational\n+  | \u0027\u003c\u0027\n+  | \u0027\u003e\u0027\n+  | \u0027\u003c\u003d\u0027\n+  | \u0027\u003e\u003d\u0027\n+  | \u0027in\u0027\n+  // Additive\n+  | \u0027+\u0027\n+  | \u0027-\u0027\n+  // Multiplicative\n+  | \u0027*\u0027\n+  | \u0027%\u0027\n+  | \u0027/\u0027\n+  // Exponentiation\n+  | \u0027**\u0027;\n+\n export class Binary extends AST {\n   constructor(\n     span: ParseSpan,\n     sourceSpan: AbsoluteSourceSpan,\n-    public operation: string,\n+    public operation: BinaryOperation,\n     public left: AST,\n     public right: AST,\n   ) {\n@@ -349,7 +377,7 @@ export class Unary extends Binary {\n     sourceSpan: AbsoluteSourceSpan,\n     public operator: string,\n     public expr: AST,\n-    binaryOp: string,\n+    binaryOp: BinaryOperation,\n     binaryLeft: AST,\n     binaryRight: AST,\n   ) {","output":"refactor(compiler): tighten `Binary.operation` type","metadata":{"id":"angular-07a08ab9","repository":"angular","commit_hash":"07a08ab9f8a209172c2f4a59169e5fde64e032ea","author":"fisker \u003clionkay@gmail.com\u003e","type":"refactor","scope":"compiler","quality_score":90}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" .../src/errors/wrong_number_of_generic_args.rs     |  3 ++\n tests/ui/generics/wrong-number-of-args-in-macro.rs | 15 ++++++++\n .../generics/wrong-number-of-args-in-macro.stderr  | 44 ++++++++++++++++++++++\n 3 files changed, 62 insertions(+)","output":"fix(generics): improve error handling for wrong number of generic args","metadata":{"id":"rust-a496d1de","repository":"rust","commit_hash":"a496d1de668953f3374b7bf10b66c861acc91802"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" packages/react-server/src/ReactFlightReplyServer.js | 17 ++++++++++++++++-\n 1 file changed, 16 insertions(+), 1 deletion(-)\n\ndiff --git a/packages/react-server/src/ReactFlightReplyServer.js b/packages/react-server/src/ReactFlightReplyServer.js\nindex 39734da..742cae6 100644\n--- a/packages/react-server/src/ReactFlightReplyServer.js\n+++ b/packages/react-server/src/ReactFlightReplyServer.js\n@@ -437,6 +437,11 @@ function loadServerReference<A: Iterable<any>, T>(\n   if (typeof id !== 'string') {\n     return (null: any);\n   }\n+  if (key === 'then') {\n+    // This should never happen because we always serialize objects with then-functions\n+    // as \"thenable\" which reduces to ReactPromise with no other fields.\n+    return (null: any);\n+  }\n   const serverReference: ServerReference<T> =\n     resolveServerReference<$FlowFixMe>(response._bundlerConfig, id);\n   // We expect most servers to not really need this because you'd just have all\n@@ -976,7 +981,17 @@ function extractIterator(response: Response, model: Array<any>): Iterator<any> {\n   return model[Symbol.iterator]();\n }\n \n-function createModel(response: Response, model: any): any {\n+function createModel(\n+  response: Response,\n+  model: any,\n+  parentObject: Object,\n+  key: string,\n+): any {\n+  if (key === 'then' && typeof model === 'function') {\n+    // This should never happen because we always serialize objects with then-functions\n+    // as \"thenable\" which reduces to ReactPromise with no other fields.\n+    return null;\n+  }\n   return model;\n }\n ","output":"fix(react-server): guard against then property in server reference","metadata":{"id":"react-3016ff87","repository":"react","commit_hash":"3016ff87d87aeff5181d95348d609039fdcad94a"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" packages/compiler-core/src/tokenizer.ts | 28 ++++++++++++++++++++++------\n 1 file changed, 22 insertions(+), 6 deletions(-)\n\ndiff --git a/packages/compiler-core/src/tokenizer.ts b/packages/compiler-core/src/tokenizer.ts\nindex 48afe9d..c6084e1 100644\n--- a/packages/compiler-core/src/tokenizer.ts\n+++ b/packages/compiler-core/src/tokenizer.ts\n@@ -296,14 +296,30 @@ export default class Tokenizer {\n   public getPos(index: number): Position {\n     let line = 1\n     let column = index + 1\n-    for (let i = this.newlines.length - 1; i >= 0; i--) {\n-      const newlineIndex = this.newlines[i]\n-      if (index > newlineIndex) {\n-        line = i + 2\n-        column = index - newlineIndex\n-        break\n+    const length = this.newlines.length\n+    let j = -1\n+    if (length > 100) {\n+      let l = -1\n+      let r = length\n+      while (l + 1 < r) {\n+        const m = (l + r) >>> 1\n+        this.newlines[m] < index ? (l = m) : (r = m)\n+      }\n+      j = l\n+    } else {\n+      for (let i = length - 1; i >= 0; i--) {\n+        if (index > this.newlines[i]) {\n+          j = i\n+          break\n+        }\n       }\n     }\n+\n+    if (j >= 0) {\n+      line = j + 2\n+      column = index - this.newlines[j]\n+    }\n+\n     return {\n       column,\n       line,","output":"refactor(compiler-core): optimize getPos with binary search","metadata":{"id":"vue-1904053f","repository":"vue","commit_hash":"1904053f1f7986c2d6dbe858ee1b594b4b229c17"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" .../__snapshots__/transformExpressions.spec.ts.snap          | 10 ++++++++++\n .../__tests__/transforms/transformExpressions.spec.ts        |  8 ++++++++\n packages/compiler-core/src/transforms/transformExpression.ts | 12 ++++++++----\n 3 files changed, 26 insertions(+), 4 deletions(-)\n\ndiff --git a/packages/compiler-core/__tests__/transforms/__snapshots__/transformExpressions.spec.ts.snap b/packages/compiler-core/__tests__/transforms/__snapshots__/transformExpressions.spec.ts.snap\nindex 5a94de5..8907962 100644\n--- a/packages/compiler-core/__tests__/transforms/__snapshots__/transformExpressions.spec.ts.snap\n+++ b/packages/compiler-core/__tests__/transforms/__snapshots__/transformExpressions.spec.ts.snap\n@@ -14,6 +14,16 @@ return function render(_ctx, _cache, $props, $setup, $data, $options) {\n }\"\n `;\n \n+exports[`compiler: expression transform > expression with type 1`] = `\n+\"const { openBlock: _openBlock, createElementBlock: _createElementBlock } = Vue\n+\n+return function render(_ctx, _cache) {\n+  return (_openBlock(), _createElementBlock(\"div\", {\n+    onClick: _ctx.handleClick\n+  }, null, 8 /* PROPS */, [\"onClick\"]))\n+}\"\n+`;\n+\n exports[`compiler: expression transform > should allow leak of var declarations in for loop 1`] = `\n \"const { openBlock: _openBlock, createElementBlock: _createElementBlock } = Vue\n \ndiff --git a/packages/compiler-core/__tests__/transforms/transformExpressions.spec.ts b/packages/compiler-core/__tests__/transforms/transformExpressions.spec.ts\nindex 2f1e6eb..47627ff 100644\n--- a/packages/compiler-core/__tests__/transforms/transformExpressions.spec.ts\n+++ b/packages/compiler-core/__tests__/transforms/transformExpressions.spec.ts\n@@ -754,4 +754,12 @@ describe('compiler: expression transform', () => {\n       expect(code).toMatch(`_ctx.bar`)\n     })\n   })\n+\n+  test('expression with type', () => {\n+    const { code } = compile(\n+      `<div @click=\"(<number>handleClick as any)\"></div>`,\n+    )\n+    expect(code).toMatch(`onClick: _ctx.handleClick`)\n+    expect(code).toMatchSnapshot()\n+  })\n })\ndiff --git a/packages/compiler-core/src/transforms/transformExpression.ts b/packages/compiler-core/src/transforms/transformExpression.ts\nindex 9ae8897..be4b09b 100644\n--- a/packages/compiler-core/src/transforms/transformExpression.ts\n+++ b/packages/compiler-core/src/transforms/transformExpression.ts\n@@ -18,6 +18,7 @@ import {\n   createSimpleExpression,\n } from '../ast'\n import {\n+  TS_NODE_TYPES,\n   isInDestructureAssignment,\n   isInNewExpression,\n   isStaticProperty,\n@@ -347,15 +348,18 @@ export function processExpression(\n   // an ExpressionNode has the `.children` property, it will be used instead of\n   // `.content`.\n   const children: CompoundExpressionNode['children'] = []\n+  const isTSNode = TS_NODE_TYPES.includes(ast.type)\n   ids.sort((a, b) => a.start - b.start)\n   ids.forEach((id, i) => {\n     // range is offset by -1 due to the wrapping parens when parsed\n     const start = id.start - 1\n     const end = id.end - 1\n     const last = ids[i - 1]\n-    const leadingText = rawExp.slice(last ? last.end - 1 : 0, start)\n-    if (leadingText.length || id.prefix) {\n-      children.push(leadingText + (id.prefix || ``))\n+    if (!(isTSNode && i === 0)) {\n+      const leadingText = rawExp.slice(last ? last.end - 1 : 0, start)\n+      if (leadingText.length || id.prefix) {\n+        children.push(leadingText + (id.prefix || ``))\n+      }\n     }\n     const source = rawExp.slice(start, end)\n     children.push(\n@@ -372,7 +376,7 @@ export function processExpression(\n           : ConstantTypes.NOT_CONSTANT,\n       ),\n     )\n-    if (i === ids.length - 1 && end < rawExp.length) {\n+    if (i === ids.length - 1 && end < rawExp.length && !isTSNode) {\n       children.push(rawExp.slice(end))\n     }\n   })","output":"fix(compiler-core): handle TypeScript type expressions correctly","metadata":{"id":"vue-e6544ac2","repository":"vue","commit_hash":"e6544ac292b5b473274f87cdb83ebeac3e7e61a4"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" compiler/rustc_builtin_macros/src/eii.rs | 3 +++\n 1 file changed, 3 insertions(+)","output":"feat(eii): add builtin macro support","metadata":{"id":"rust-daae6601","repository":"rust","commit_hash":"daae6601be4eca73dd75ccb983a15485d4515196"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" docs/en/docs/release-notes.md | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a/docs/en/docs/release-notes.md b/docs/en/docs/release-notes.md\nindex 584137f..1380d7f 100644\n--- a/docs/en/docs/release-notes.md\n+++ b/docs/en/docs/release-notes.md\n@@ -14,6 +14,7 @@ hide:\n \n ### Internal\n \n+* üî® Update LLM translation script to guide reviewers to change the prompt. PR [#14614](https://github.com/fastapi/fastapi/pull/14614) by [@tiangolo](https://github.com/tiangolo).\n * üë∑ Do not run translations on cron while finishing updating existing languages. PR [#14613](https://github.com/fastapi/fastapi/pull/14613) by [@tiangolo](https://github.com/tiangolo).\n * üî• Remove test variants for Pydantic v1 in test_request_params. PR [#14612](https://github.com/fastapi/fastapi/pull/14612) by [@tiangolo](https://github.com/tiangolo).\n * üî• Remove Pydantic v1  specific test variants. PR [#14611](https://github.com/fastapi/fastapi/pull/14611) by [@tiangolo](https://github.com/tiangolo).","output":"docs: update release notes","metadata":{"id":"fastapi-47391ea8","repository":"fastapi","commit_hash":"47391ea8fbdfcedf6ff3f4a56666ccf928ca10c2"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" scripts/translate.py | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\ndiff --git a/scripts/translate.py b/scripts/translate.py\nindex 6ebd24f..66da46a 100644\n--- a/scripts/translate.py\n+++ b/scripts/translate.py\n@@ -1036,9 +1036,13 @@ def make_pr(\n     print(\"Creating PR\")\n     g = Github(github_token)\n     gh_repo = g.get_repo(github_repository)\n-    pr = gh_repo.create_pull(\n-        title=message, body=message, base=\"master\", head=branch_name\n+    body = (\n+        message\n+        + \"\\n\\nThis PR was created automatically using LLMs.\"\n+        + f\"\\n\\nIt uses the prompt file https://github.com/fastapi/fastapi/blob/master/docs/{language}/llm-prompt.md.\"\n+        + \"\\n\\nIn most cases, it's better to make PRs updating that file so that the LLM can do a better job generating the translations than suggesting changes in this PR.\"\n     )\n+    pr = gh_repo.create_pull(title=message, body=body, base=\"master\", head=branch_name)\n     print(f\"Created PR: {pr.number}\")\n     print(\"Finished\")\n ","output":"feat(translate): add detailed body to auto-generated PRs","metadata":{"id":"fastapi-3b1b4f03","repository":"fastapi","commit_hash":"3b1b4f034bebddb873d4bd8c1bb5f52aaae17240"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" .../src/CompilerError.ts                           |  4 +-\n .../src/HIR/Environment.ts                         | 10 +++\n .../src/Validation/ValidateNoSetStateInEffects.ts  | 72 +++++++++++-----\n ...state-in-effect-verbose-derived-event.expect.md | 74 +++++++++++++++++\n ...id-set-state-in-effect-verbose-derived-event.js | 18 ++++\n ...-state-in-effect-verbose-force-update.expect.md | 97 ++++++++++++++++++++++\n ...lid-set-state-in-effect-verbose-force-update.js | 28 +++++++\n ...e-in-effect-verbose-non-local-derived.expect.md | 68 +++++++++++++++\n ...et-state-in-effect-verbose-non-local-derived.js | 15 ++++\n 9 files changed, 365 insertions(+), 21 deletions(-)\n\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/CompilerError.ts b/compiler/packages/babel-plugin-react-compiler/src/CompilerError.ts\nindex a8869fd..a61967e 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/CompilerError.ts\n+++ b/compiler/packages/babel-plugin-react-compiler/src/CompilerError.ts\n@@ -869,7 +869,9 @@ function getRuleForCategoryImpl(category: ErrorCategory): LintRule {\n         severity: ErrorSeverity.Error,\n         name: 'set-state-in-effect',\n         description:\n-          'Validates against calling setState synchronously in an effect, which can lead to re-renders that degrade performance',\n+          'Validates against calling setState synchronously in an effect. ' +\n+          'This can indicate non-local derived data, a derived event pattern, or ' +\n+          'improper external data synchronization.',\n         preset: LintRulePreset.Recommended,\n       };\n     }\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts b/compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts\nindex 87737f0..05105ae 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts\n+++ b/compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts\n@@ -700,6 +700,16 @@ export const EnvironmentConfigSchema = z.object({\n    */\n   enableAllowSetStateFromRefsInEffects: z.boolean().default(true),\n \n+  /**\n+   * When enabled, provides verbose error messages for setState calls within effects,\n+   * presenting multiple possible fixes to the user/agent since we cannot statically\n+   * determine which specific use-case applies:\n+   * 1. Non-local derived data - requires restructuring state ownership\n+   * 2. Derived event pattern - detecting when a prop changes\n+   * 3. Force update / external sync - should use useSyncExternalStore\n+   */\n+  enableVerboseNoSetStateInEffect: z.boolean().default(false),\n+\n   /**\n    * Enables inference of event handler types for JSX props on built-in DOM elements.\n    * When enabled, functions passed to event handler props (props starting with \"on\")\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoSetStateInEffects.ts b/compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoSetStateInEffects.ts\nindex 86070e2..91de8f2 100644\n--- a/compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoSetStateInEffects.ts\n+++ b/compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoSetStateInEffects.ts\n@@ -121,26 +121,58 @@ export function validateNoSetStateInEffects(\n             if (arg !== undefined && arg.kind === 'Identifier') {\n               const setState = setStateFunctions.get(arg.identifier.id);\n               if (setState !== undefined) {\n-                errors.pushDiagnostic(\n-                  CompilerDiagnostic.create({\n-                    category: ErrorCategory.EffectSetState,\n-                    reason:\n-                      'Calling setState synchronously within an effect can trigger cascading renders',\n-                    description:\n-                      'Effects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. ' +\n-                      'In general, the body of an effect should do one or both of the following:\\n' +\n-                      '* Update external systems with the latest state from React.\\n' +\n-                      '* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\\n\\n' +\n-                      'Calling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. ' +\n-                      '(https://react.dev/learn/you-might-not-need-an-effect)',\n-                    suggestions: null,\n-                  }).withDetails({\n-                    kind: 'error',\n-                    loc: setState.loc,\n-                    message:\n-                      'Avoid calling setState() directly within an effect',\n-                  }),\n-                );\n+                const enableVerbose =\n+                  env.config.enableVerboseNoSetStateInEffect;\n+                if (enableVerbose) {\n+                  errors.pushDiagnostic(\n+                    CompilerDiagnostic.create({\n+                      category: ErrorCategory.EffectSetState,\n+                      reason:\n+                        'Calling setState synchronously within an effect can trigger cascading renders',\n+                      description:\n+                        'Effects are intended to synchronize state between React and external systems. ' +\n+                        'Calling setState synchronously causes cascading renders that hurt performance.\\n\\n' +\n+                        'This pattern may indicate one of several issues:\\n\\n' +\n+                        '**1. Non-local derived data**: If the value being set could be computed from props/state ' +\n+                        'but requires data from a parent component, consider restructuring state ownership so the ' +\n+                        'derivation can happen during render in the component that owns the relevant state.\\n\\n' +\n+                        \"**2. Derived event pattern**: If you're detecting when a prop changes (e.g., `isPlaying` \" +\n+                        'transitioning from false to true), this often indicates the parent should provide an event ' +\n+                        'callback (like `onPlay`) instead of just the current state. Request access to the original event.\\n\\n' +\n+                        \"**3. Force update / external sync**: If you're forcing a re-render to sync with an external \" +\n+                        'data source (mutable values outside React), use `useSyncExternalStore` to properly subscribe ' +\n+                        'to external state changes.\\n\\n' +\n+                        'See: https://react.dev/learn/you-might-not-need-an-effect',\n+                      suggestions: null,\n+                    }).withDetails({\n+                      kind: 'error',\n+                      loc: setState.loc,\n+                      message:\n+                        'Avoid calling setState() directly within an effect',\n+                    }),\n+                  );\n+                } else {\n+                  errors.pushDiagnostic(\n+                    CompilerDiagnostic.create({\n+                      category: ErrorCategory.EffectSetState,\n+                      reason:\n+                        'Calling setState synchronously within an effect can trigger cascading renders',\n+                      description:\n+                        'Effects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. ' +\n+                        'In general, the body of an effect should do one or both of the following:\\n' +\n+                        '* Update external systems with the latest state from React.\\n' +\n+                        '* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\\n\\n' +\n+                        'Calling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. ' +\n+                        '(https://react.dev/learn/you-might-not-need-an-effect)',\n+                      suggestions: null,\n+                    }).withDetails({\n+                      kind: 'error',\n+                      loc: setState.loc,\n+                      message:\n+                        'Avoid calling setState() directly within an effect',\n+                    }),\n+                  );\n+                }\n               }\n             }\n           }\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-derived-event.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-derived-event.expect.md\nnew file mode 100644\nindex 0000000..60479b8\n--- /dev/null\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-derived-event.expect.md\n@@ -0,0 +1,74 @@\n+\n+## Input\n+\n+```javascript\n+// @validateNoSetStateInEffects @enableVerboseNoSetStateInEffect\n+import {useState, useEffect} from 'react';\n+\n+function VideoPlayer({isPlaying}) {\n+  const [wasPlaying, setWasPlaying] = useState(isPlaying);\n+  useEffect(() => {\n+    if (isPlaying !== wasPlaying) {\n+      setWasPlaying(isPlaying);\n+      console.log('Play state changed!');\n+    }\n+  }, [isPlaying, wasPlaying]);\n+  return <video />;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: VideoPlayer,\n+  params: [{isPlaying: true}],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\"; // @validateNoSetStateInEffects @enableVerboseNoSetStateInEffect\n+import { useState, useEffect } from \"react\";\n+\n+function VideoPlayer(t0) {\n+  const $ = _c(5);\n+  const { isPlaying } = t0;\n+  const [wasPlaying, setWasPlaying] = useState(isPlaying);\n+  let t1;\n+  let t2;\n+  if ($[0] !== isPlaying || $[1] !== wasPlaying) {\n+    t1 = () => {\n+      if (isPlaying !== wasPlaying) {\n+        setWasPlaying(isPlaying);\n+        console.log(\"Play state changed!\");\n+      }\n+    };\n+\n+    t2 = [isPlaying, wasPlaying];\n+    $[0] = isPlaying;\n+    $[1] = wasPlaying;\n+    $[2] = t1;\n+    $[3] = t2;\n+  } else {\n+    t1 = $[2];\n+    t2 = $[3];\n+  }\n+  useEffect(t1, t2);\n+  let t3;\n+  if ($[4] === Symbol.for(\"react.memo_cache_sentinel\")) {\n+    t3 = <video />;\n+    $[4] = t3;\n+  } else {\n+    t3 = $[4];\n+  }\n+  return t3;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: VideoPlayer,\n+  params: [{ isPlaying: true }],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) <video></video>\n\\ No newline at end of file\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-derived-event.js b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-derived-event.js\nnew file mode 100644\nindex 0000000..4928dbe\n--- /dev/null\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-derived-event.js\n@@ -0,0 +1,18 @@\n+// @validateNoSetStateInEffects @enableVerboseNoSetStateInEffect\n+import {useState, useEffect} from 'react';\n+\n+function VideoPlayer({isPlaying}) {\n+  const [wasPlaying, setWasPlaying] = useState(isPlaying);\n+  useEffect(() => {\n+    if (isPlaying !== wasPlaying) {\n+      setWasPlaying(isPlaying);\n+      console.log('Play state changed!');\n+    }\n+  }, [isPlaying, wasPlaying]);\n+  return <video />;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: VideoPlayer,\n+  params: [{isPlaying: true}],\n+};\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-force-update.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-force-update.expect.md\nnew file mode 100644\nindex 0000000..131eb99\n--- /dev/null\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-force-update.expect.md\n@@ -0,0 +1,97 @@\n+\n+## Input\n+\n+```javascript\n+// @validateNoSetStateInEffects @enableVerboseNoSetStateInEffect\n+import {useState, useEffect} from 'react';\n+\n+const externalStore = {\n+  value: 0,\n+  subscribe(callback) {\n+    return () => {};\n+  },\n+  getValue() {\n+    return this.value;\n+  },\n+};\n+\n+function ExternalDataComponent() {\n+  const [, forceUpdate] = useState({});\n+  useEffect(() => {\n+    const unsubscribe = externalStore.subscribe(() => {\n+      forceUpdate({});\n+    });\n+    return unsubscribe;\n+  }, []);\n+  return <div>{externalStore.getValue()}</div>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: ExternalDataComponent,\n+  params: [],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\"; // @validateNoSetStateInEffects @enableVerboseNoSetStateInEffect\n+import { useState, useEffect } from \"react\";\n+\n+const externalStore = {\n+  value: 0,\n+  subscribe(callback) {\n+    return () => {};\n+  },\n+  getValue() {\n+    return this.value;\n+  },\n+};\n+\n+function ExternalDataComponent() {\n+  const $ = _c(4);\n+  let t0;\n+  if ($[0] === Symbol.for(\"react.memo_cache_sentinel\")) {\n+    t0 = {};\n+    $[0] = t0;\n+  } else {\n+    t0 = $[0];\n+  }\n+  const [, forceUpdate] = useState(t0);\n+  let t1;\n+  let t2;\n+  if ($[1] === Symbol.for(\"react.memo_cache_sentinel\")) {\n+    t1 = () => {\n+      const unsubscribe = externalStore.subscribe(() => {\n+        forceUpdate({});\n+      });\n+      return unsubscribe;\n+    };\n+    t2 = [];\n+    $[1] = t1;\n+    $[2] = t2;\n+  } else {\n+    t1 = $[1];\n+    t2 = $[2];\n+  }\n+  useEffect(t1, t2);\n+  let t3;\n+  if ($[3] === Symbol.for(\"react.memo_cache_sentinel\")) {\n+    t3 = <div>{externalStore.getValue()}</div>;\n+    $[3] = t3;\n+  } else {\n+    t3 = $[3];\n+  }\n+  return t3;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: ExternalDataComponent,\n+  params: [],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) <div>0</div>\n\\ No newline at end of file\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-force-update.js b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-force-update.js\nnew file mode 100644\nindex 0000000..e7653d1\n--- /dev/null\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-force-update.js\n@@ -0,0 +1,28 @@\n+// @validateNoSetStateInEffects @enableVerboseNoSetStateInEffect\n+import {useState, useEffect} from 'react';\n+\n+const externalStore = {\n+  value: 0,\n+  subscribe(callback) {\n+    return () => {};\n+  },\n+  getValue() {\n+    return this.value;\n+  },\n+};\n+\n+function ExternalDataComponent() {\n+  const [, forceUpdate] = useState({});\n+  useEffect(() => {\n+    const unsubscribe = externalStore.subscribe(() => {\n+      forceUpdate({});\n+    });\n+    return unsubscribe;\n+  }, []);\n+  return <div>{externalStore.getValue()}</div>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: ExternalDataComponent,\n+  params: [],\n+};\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-non-local-derived.expect.md b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-non-local-derived.expect.md\nnew file mode 100644\nindex 0000000..35cdeb2\n--- /dev/null\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-non-local-derived.expect.md\n@@ -0,0 +1,68 @@\n+\n+## Input\n+\n+```javascript\n+// @validateNoSetStateInEffects @enableVerboseNoSetStateInEffect\n+import {useState, useEffect} from 'react';\n+\n+function Child({firstName, lastName}) {\n+  const [fullName, setFullName] = useState('');\n+  useEffect(() => {\n+    setFullName(firstName + ' ' + lastName);\n+  }, [firstName, lastName]);\n+  return <div>{fullName}</div>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Child,\n+  params: [{firstName: 'John', lastName: 'Doe'}],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\"; // @validateNoSetStateInEffects @enableVerboseNoSetStateInEffect\n+import { useState, useEffect } from \"react\";\n+\n+function Child(t0) {\n+  const $ = _c(6);\n+  const { firstName, lastName } = t0;\n+  const [fullName, setFullName] = useState(\"\");\n+  let t1;\n+  let t2;\n+  if ($[0] !== firstName || $[1] !== lastName) {\n+    t1 = () => {\n+      setFullName(firstName + \" \" + lastName);\n+    };\n+    t2 = [firstName, lastName];\n+    $[0] = firstName;\n+    $[1] = lastName;\n+    $[2] = t1;\n+    $[3] = t2;\n+  } else {\n+    t1 = $[2];\n+    t2 = $[3];\n+  }\n+  useEffect(t1, t2);\n+  let t3;\n+  if ($[4] !== fullName) {\n+    t3 = <div>{fullName}</div>;\n+    $[4] = fullName;\n+    $[5] = t3;\n+  } else {\n+    t3 = $[5];\n+  }\n+  return t3;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Child,\n+  params: [{ firstName: \"John\", lastName: \"Doe\" }],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) <div>John Doe</div>\n\\ No newline at end of file\ndiff --git a/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-non-local-derived.js b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-non-local-derived.js\nnew file mode 100644\nindex 0000000..eba6b5c\n--- /dev/null\n+++ b/compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/invalid-set-state-in-effect-verbose-non-local-derived.js\n@@ -0,0 +1,15 @@\n+// @validateNoSetStateInEffects @enableVerboseNoSetStateInEffect\n+import {useState, useEffect} from 'react';\n+\n+function Child({firstName, lastName}) {\n+  const [fullName, setFullName] = useState('');\n+  useEffect(() => {\n+    setFullName(firstName + ' ' + lastName);\n+  }, [firstName, lastName]);\n+  return <div>{fullName}</div>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Child,\n+  params: [{firstName: 'John', lastName: 'Doe'}],\n+};","output":"feat(compiler): add verbose mode for setState-in-effect validation","metadata":{"id":"react-3640f38a","repository":"react","commit_hash":"3640f38a728f3a057649cf7aec65a6ce14c2eac0"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" src/os/exec/exec.go | 6 ++++--\n 1 file changed, 4 insertions(+), 2 deletions(-)\n\ndiff --git a/src/os/exec/exec.go b/src/os/exec/exec.go\nindex e0c509cb..aa7a6be7 100644\n--- a/src/os/exec/exec.go\n+++ b/src/os/exec/exec.go\n@@ -357,7 +357,9 @@ type Cmd struct {\n \tcachedLookExtensions struct{ in, out string }\n \n \t// startCalled records that Start was attempted, regardless of outcome.\n-\tstartCalled atomic.Bool\n+\t// (Until go.dev/issue/77075 is resolved, we use atomic.SwapInt32,\n+\t// not atomic.Bool.Swap, to avoid triggering the copylocks vet check.)\n+\tstartCalled int32\n }\n \n // A ctxResult reports the result of watching the Context associated with a\n@@ -640,7 +642,7 @@ func (c *Cmd) Start() error {\n \t// Check for doubled Start calls before we defer failure cleanup. If the prior\n \t// call to Start succeeded, we don't want to spuriously close its pipes.\n \t// It is an error to call Start twice even if the first call did not create a process.\n-\tif c.startCalled.Swap(true) {\n+\tif atomic.SwapInt32(&c.startCalled, 1) != 0 {\n \t\treturn errors.New(\"exec: already started\")\n \t}\n ","output":"fix(exec): use atomic.SwapInt32 to avoid copylocks vet check","metadata":{"id":"go-d1d0fc7a","repository":"go","commit_hash":"d1d0fc7a97539206e33f04bac935f6450597137c"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" packages/runtime-dom/src/index.ts | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a/packages/runtime-dom/src/index.ts b/packages/runtime-dom/src/index.ts\nindex 9b87827..7407ed7 100644\n--- a/packages/runtime-dom/src/index.ts\n+++ b/packages/runtime-dom/src/index.ts\n@@ -17,6 +17,7 @@ import {\n } from '@vue/runtime-core'\n import { nodeOps } from './nodeOps'\n import { patchProp } from './patchProp'\n+export { nodeOps, patchProp }\n // Importing from the compiler, will be tree-shaken in prod\n import {\n   NOOP,","output":"feat(runtime-dom): export nodeOps and patchProp","metadata":{"id":"vue-e9c676ff","repository":"vue","commit_hash":"e9c676ff2b64724ad74f017bd280d623e8d72e6b"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" packages/react-server/src/ReactFlightReplyServer.js | 8 +++++++-\n 1 file changed, 7 insertions(+), 1 deletion(-)\n\ndiff --git a/packages/react-server/src/ReactFlightReplyServer.js b/packages/react-server/src/ReactFlightReplyServer.js\nindex 4d5a6da..88781cc 100644\n--- a/packages/react-server/src/ReactFlightReplyServer.js\n+++ b/packages/react-server/src/ReactFlightReplyServer.js\n@@ -133,14 +133,20 @@ ReactPromise.prototype.then = function <T>(\n         // Recursively check if the value is itself a ReactPromise and if so if it points\n         // back to itself. This helps catch recursive thenables early error.\n         let cycleProtection = 0;\n+        const visited = new Set<typeof ReactPromise>();\n         while (inspectedValue instanceof ReactPromise) {\n           cycleProtection++;\n-          if (inspectedValue === chunk || cycleProtection > 1000) {\n+          if (\n+            inspectedValue === chunk ||\n+            visited.has(inspectedValue) ||\n+            cycleProtection > 1000\n+          ) {\n             if (typeof reject === 'function') {\n               reject(new Error('Cannot have cyclic thenables.'));\n             }\n             return;\n           }\n+          visited.add(inspectedValue);\n           if (inspectedValue.status === INITIALIZED) {\n             inspectedValue = inspectedValue.value;\n           } else {","output":"fix(react-server): improve cyclic thenable detection","metadata":{"id":"react-b731fe28","repository":"react","commit_hash":"b731fe28cc492cb36c51c89866f5b63a3ffae2aa"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commits format: type(scope): description\n\nValid types: feat, fix, docs, style, refactor, perf, test, build, ci, chore\n\nRules:\n- Keep the subject line under 72 characters\n- Start description with lowercase\n- Do not end with a period\n- Be concise and specific","input":" vscode-ng-language-service/CHANGELOG.md | 6 ++++++\n 1 file changed, 6 insertions(+)\n\ndiff --git a/vscode-ng-language-service/CHANGELOG.md b/vscode-ng-language-service/CHANGELOG.md\nindex c4e83534..9de2d943 100644\n--- a/vscode-ng-language-service/CHANGELOG.md\n+++ b/vscode-ng-language-service/CHANGELOG.md\n@@ -1,3 +1,9 @@\n+## 21.1.0 (2026-01-12)\n+\n+- fix(vscode-extension): convert enum member kind in completions correctly ([50674f8c28](https://github.com/angular/angular/commit/50674f8c28c970e6a9cfe222f9f55bace4e16321))\n+\n+\u003c!-- CHANGELOG SPLIT MARKER --\u003e\n+\n ## 21.0.1 (2025-12-17)\n \n - fix(language-service): Prevent language service from crashing on suggestion diagnostic errors ([5047be4bc1](https://github.com/angular/angular/commit/5047be4bc1c6f6016263703c743f8033f669f0ee))","output":"docs: release notes for the vscode extension 21.1.0 release","metadata":{"id":"angular-e45f8afd","repository":"angular","commit_hash":"e45f8afdab1ad26128a2f3865eafd52db7cd4265","author":"Andrew Scott \u003catscott@google.com\u003e","type":"docs","quality_score":80}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" compiler/rustc_resolve/src/imports.rs         |  6 +++---\n tests/ui/imports/overwrite-deep-glob.rs       | 22 ++++++++++++++++++++++\n tests/ui/imports/overwrite-deep-glob.stderr   | 12 ++++++++++++\n tests/ui/imports/overwrite-different-ambig.rs | 25 +++++++++++++++++++++++++\n tests/ui/imports/overwrite-different-vis.rs   | 21 +++++++++++++++++++++\n 5 files changed, 83 insertions(+), 3 deletions(-)\n\ndiff --git a/compiler/rustc_resolve/src/imports.rs b/compiler/rustc_resolve/src/imports.rs\nindex e525abd00f9..7c0cbcf1d52 100644\n--- a/compiler/rustc_resolve/src/imports.rs\n+++ b/compiler/rustc_resolve/src/imports.rs\n@@ -300,13 +300,13 @@ fn remove_same_import<'ra>(d1: Decl<'ra>, d2: Decl<'ra>) -> (Decl<'ra>, Decl<'ra\n     if let DeclKind::Import { import: import1, source_decl: d1_next } = d1.kind\n         && let DeclKind::Import { import: import2, source_decl: d2_next } = d2.kind\n         && import1 == import2\n-        && d1.warn_ambiguity.get() == d2.warn_ambiguity.get()\n     {\n         assert_eq!(d1.ambiguity.get(), d2.ambiguity.get());\n-        assert!(!d1.warn_ambiguity.get());\n         assert_eq!(d1.expansion, d2.expansion);\n         assert_eq!(d1.span, d2.span);\n-        assert_eq!(d1.vis(), d2.vis());\n+        // Visibility of the new import declaration may be different,\n+        // because it already incorporates the visibility of the source binding.\n+        // `warn_ambiguity` of a re-fetched glob can also change in both directions.\n         remove_same_import(d1_next, d2_next)\n     } else {\n         (d1, d2)\ndiff --git a/tests/ui/imports/overwrite-deep-glob.rs b/tests/ui/imports/overwrite-deep-glob.rs\nnew file mode 100644\nindex 00000000000..261b22f6e0a\n--- /dev/null\n+++ b/tests/ui/imports/overwrite-deep-glob.rs\n@@ -0,0 +1,22 @@\n+//@ check-pass\n+\n+mod openssl {\n+    pub use self::handwritten::*;\n+\n+    mod handwritten {\n+        mod m1 {\n+            pub struct S {}\n+        }\n+        mod m2 {\n+            #[derive(Default)]\n+            pub struct S {}\n+        }\n+\n+        pub use self::m1::*; //~ WARN ambiguous glob re-exports\n+        pub use self::m2::*;\n+    }\n+}\n+\n+pub use openssl::*;\n+\n+fn main() {}\ndiff --git a/tests/ui/imports/overwrite-deep-glob.stderr b/tests/ui/imports/overwrite-deep-glob.stderr\nnew file mode 100644\nindex 00000000000..093478c57c9\n--- /dev/null\n+++ b/tests/ui/imports/overwrite-deep-glob.stderr\n@@ -0,0 +1,12 @@\n+warning: ambiguous glob re-exports\n+  --> $DIR/overwrite-deep-glob.rs:15:17\n+   |\n+LL |         pub use self::m1::*;\n+   |                 ^^^^^^^^^^^ the name `S` in the type namespace is first re-exported here\n+LL |         pub use self::m2::*;\n+   |                 ----------- but the name `S` in the type namespace is also re-exported here\n+   |\n+   = note: `#[warn(ambiguous_glob_reexports)]` on by default\n+\n+warning: 1 warning emitted\n+\ndiff --git a/tests/ui/imports/overwrite-different-ambig.rs b/tests/ui/imports/overwrite-different-ambig.rs\nnew file mode 100644\nindex 00000000000..9aee63e1897\n--- /dev/null\n+++ b/tests/ui/imports/overwrite-different-ambig.rs\n@@ -0,0 +1,25 @@\n+//@ check-pass\n+//@ edition:2024\n+\n+mod a {\n+    mod b {\n+        mod c {\n+            pub struct E;\n+        }\n+        mod d {\n+            mod c {\n+                pub struct E;\n+            }\n+            mod d {\n+                #[derive(Debug)]\n+                pub struct E;\n+            }\n+            pub use c::*;\n+            use d::*;\n+        }\n+        use c::*;\n+        use d::*;\n+    }\n+}\n+\n+fn main() {}\ndiff --git a/tests/ui/imports/overwrite-different-vis.rs b/tests/ui/imports/overwrite-different-vis.rs\nnew file mode 100644\nindex 00000000000..edcc441bcb7\n--- /dev/null\n+++ b/tests/ui/imports/overwrite-different-vis.rs\n@@ -0,0 +1,21 @@\n+//@ check-pass\n+\n+mod b {\n+    pub mod http {\n+        pub struct HeaderMap;\n+    }\n+\n+    pub(crate) use self::http::*;\n+    #[derive(Debug)]\n+    pub struct HeaderMap;\n+}\n+\n+mod a {\n+    pub use crate::b::*;\n+\n+    fn check_type() {\n+        let _: HeaderMap = crate::b::HeaderMap;\n+    }\n+}\n+\n+fn main() {}","output":"fix(resolve): relax assertions in import deduplication","metadata":{"id":"rust-8b52c73b","repository":"rust","commit_hash":"8b52c73b3ec29dadf5df8dc02aeea5aeea778fd7"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" src/cmd/compile/internal/ssa/_gen/AMD64.rules      |  7 ++\n src/cmd/compile/internal/ssa/_gen/genericOps.go    |  8 +++\n src/cmd/compile/internal/ssa/_gen/simdAMD64.rules  |  6 --\n .../compile/internal/ssa/_gen/simdgenericOps.go    |  6 --\n src/cmd/compile/internal/ssa/opGen.go              | 78 ++++++++++----------\n src/cmd/compile/internal/ssa/rewriteAMD64.go       | 84 ++++++++++------------\n src/cmd/compile/internal/ssagen/intrinsics.go      |  6 ++\n src/cmd/compile/internal/ssagen/simdintrinsics.go  |  6 --\n .../_gen/simdgen/ops/Compares/categories.yaml      |  5 --\n .../archsimd/_gen/simdgen/ops/Compares/go.yaml     |  4 +-\n src/simd/archsimd/extra_amd64.go                   | 36 ++++++++++\n src/simd/archsimd/ops_amd64.go                     | 32 ---------\n 12 files changed, 131 insertions(+), 147 deletions(-)\n\ndiff --git a/src/cmd/compile/internal/ssa/_gen/AMD64.rules b/src/cmd/compile/internal/ssa/_gen/AMD64.rules\nindex 38ca44f7..9c541868 100644\n--- a/src/cmd/compile/internal/ssa/_gen/AMD64.rules\n+++ b/src/cmd/compile/internal/ssa/_gen/AMD64.rules\n@@ -1730,6 +1730,13 @@\n // Misc\n (IsZeroVec x) => (SETEQ (VPTEST x x))\n \n+(IsNaNFloat32x4  x) => (VCMPPS128 [3] x x)\n+(IsNaNFloat32x8  x) => (VCMPPS256 [3] x x)\n+(IsNaNFloat32x16 x) => (VPMOVMToVec32x16 (VCMPPS512 [3] x x))\n+(IsNaNFloat64x2  x) => (VCMPPD128 [3] x x)\n+(IsNaNFloat64x4  x) => (VCMPPD256 [3] x x)\n+(IsNaNFloat64x8  x) => (VPMOVMToVec64x8 (VCMPPD512 [3] x x))\n+\n // SIMD vector K-masked loads and stores\n \n (LoadMasked64 <t> ptr mask mem) && t.Size() == 64 => (VPMASK64load512 ptr (VPMOVVec64x8ToM  <types.TypeMask> mask) mem)\ndiff --git a/src/cmd/compile/internal/ssa/_gen/genericOps.go b/src/cmd/compile/internal/ssa/_gen/genericOps.go\nindex 8637133e..85bde1aa 100644\n--- a/src/cmd/compile/internal/ssa/_gen/genericOps.go\n+++ b/src/cmd/compile/internal/ssa/_gen/genericOps.go\n@@ -715,6 +715,14 @@ var genericOps = []opData{\n \n \t// Returns true if arg0 is all zero.\n \t{name: \"IsZeroVec\", argLength: 1},\n+\n+\t// Returns a mask indicating whether arg0's elements are NaN.\n+\t{name: \"IsNaNFloat32x4\", argLength: 1},\n+\t{name: \"IsNaNFloat32x8\", argLength: 1},\n+\t{name: \"IsNaNFloat32x16\", argLength: 1},\n+\t{name: \"IsNaNFloat64x2\", argLength: 1},\n+\t{name: \"IsNaNFloat64x4\", argLength: 1},\n+\t{name: \"IsNaNFloat64x8\", argLength: 1},\n }\n \n //     kind          controls          successors   implicit exit\ndiff --git a/src/cmd/compile/internal/ssa/_gen/simdAMD64.rules b/src/cmd/compile/internal/ssa/_gen/simdAMD64.rules\nindex 8a5b70da..5c83f39a 100644\n--- a/src/cmd/compile/internal/ssa/_gen/simdAMD64.rules\n+++ b/src/cmd/compile/internal/ssa/_gen/simdAMD64.rules\n@@ -559,12 +559,6 @@\n (InterleaveLoGroupedUint32x16 ...) => (VPUNPCKLDQ512 ...)\n (InterleaveLoGroupedUint64x4 ...) => (VPUNPCKLQDQ256 ...)\n (InterleaveLoGroupedUint64x8 ...) => (VPUNPCKLQDQ512 ...)\n-(IsNanFloat32x4 x y) => (VCMPPS128 [3] x y)\n-(IsNanFloat32x8 x y) => (VCMPPS256 [3] x y)\n-(IsNanFloat32x16 x y) => (VPMOVMToVec32x16 (VCMPPS512 [3] x y))\n-(IsNanFloat64x2 x y) => (VCMPPD128 [3] x y)\n-(IsNanFloat64x4 x y) => (VCMPPD256 [3] x y)\n-(IsNanFloat64x8 x y) => (VPMOVMToVec64x8 (VCMPPD512 [3] x y))\n (LeadingZerosInt32x4 ...) => (VPLZCNTD128 ...)\n (LeadingZerosInt32x8 ...) => (VPLZCNTD256 ...)\n (LeadingZerosInt32x16 ...) => (VPLZCNTD512 ...)\ndiff --git a/src/cmd/compile/internal/ssa/_gen/simdgenericOps.go b/src/cmd/compile/internal/ssa/_gen/simdgenericOps.go\nindex af1007cd..889ab0d8 100644\n--- a/src/cmd/compile/internal/ssa/_gen/simdgenericOps.go\n+++ b/src/cmd/compile/internal/ssa/_gen/simdgenericOps.go\n@@ -519,12 +519,6 @@ func simdGenericOps() []opData {\n \t\t{name: \"InterleaveLoUint16x8\", argLength: 2, commutative: false},\n \t\t{name: \"InterleaveLoUint32x4\", argLength: 2, commutative: false},\n \t\t{name: \"InterleaveLoUint64x2\", argLength: 2, commutative: false},\n-\t\t{name: \"IsNanFloat32x4\", argLength: 2, commutative: true},\n-\t\t{name: \"IsNanFloat32x8\", argLength: 2, commutative: true},\n-\t\t{name: \"IsNanFloat32x16\", argLength: 2, commutative: true},\n-\t\t{name: \"IsNanFloat64x2\", argLength: 2, commutative: true},\n-\t\t{name: \"IsNanFloat64x4\", argLength: 2, commutative: true},\n-\t\t{name: \"IsNanFloat64x8\", argLength: 2, commutative: true},\n \t\t{name: \"LeadingZerosInt32x4\", argLength: 1, commutative: false},\n \t\t{name: \"LeadingZerosInt32x8\", argLength: 1, commutative: false},\n \t\t{name: \"LeadingZerosInt32x16\", argLength: 1, commutative: false},\ndiff --git a/src/cmd/compile/internal/ssa/opGen.go b/src/cmd/compile/internal/ssa/opGen.go\nindex d2ba15f7..abaf7911 100644\n--- a/src/cmd/compile/internal/ssa/opGen.go\n+++ b/src/cmd/compile/internal/ssa/opGen.go\n@@ -6158,6 +6158,12 @@ const (\n \tOpCvtMask64x4to8\n \tOpCvtMask64x8to8\n \tOpIsZeroVec\n+\tOpIsNaNFloat32x4\n+\tOpIsNaNFloat32x8\n+\tOpIsNaNFloat32x16\n+\tOpIsNaNFloat64x2\n+\tOpIsNaNFloat64x4\n+\tOpIsNaNFloat64x8\n \tOpAESDecryptLastRoundUint8x16\n \tOpAESDecryptLastRoundUint8x32\n \tOpAESDecryptLastRoundUint8x64\n@@ -6673,12 +6679,6 @@ const (\n \tOpInterleaveLoUint16x8\n \tOpInterleaveLoUint32x4\n \tOpInterleaveLoUint64x2\n-\tOpIsNanFloat32x4\n-\tOpIsNanFloat32x8\n-\tOpIsNanFloat32x16\n-\tOpIsNanFloat64x2\n-\tOpIsNanFloat64x4\n-\tOpIsNanFloat64x8\n \tOpLeadingZerosInt32x4\n \tOpLeadingZerosInt32x8\n \tOpLeadingZerosInt32x16\n@@ -88993,6 +88993,36 @@ var opcodeTable = [...]opInfo{\n \t\targLen:  1,\n \t\tgeneric: true,\n \t},\n+\t{\n+\t\tname:    \"IsNaNFloat32x4\",\n+\t\targLen:  1,\n+\t\tgeneric: true,\n+\t},\n+\t{\n+\t\tname:    \"IsNaNFloat32x8\",\n+\t\targLen:  1,\n+\t\tgeneric: true,\n+\t},\n+\t{\n+\t\tname:    \"IsNaNFloat32x16\",\n+\t\targLen:  1,\n+\t\tgeneric: true,\n+\t},\n+\t{\n+\t\tname:    \"IsNaNFloat64x2\",\n+\t\targLen:  1,\n+\t\tgeneric: true,\n+\t},\n+\t{\n+\t\tname:    \"IsNaNFloat64x4\",\n+\t\targLen:  1,\n+\t\tgeneric: true,\n+\t},\n+\t{\n+\t\tname:    \"IsNaNFloat64x8\",\n+\t\targLen:  1,\n+\t\tgeneric: true,\n+\t},\n \t{\n \t\tname:    \"AESDecryptLastRoundUint8x16\",\n \t\targLen:  2,\n@@ -91670,42 +91700,6 @@ var opcodeTable = [...]opInfo{\n \t\targLen:  2,\n \t\tgeneric: true,\n \t},\n-\t{\n-\t\tname:        \"IsNanFloat32x4\",\n-\t\targLen:      2,\n-\t\tcommutative: true,\n-\t\tgeneric:     true,\n-\t},\n-\t{\n-\t\tname:        \"IsNanFloat32x8\",\n-\t\targLen:      2,\n-\t\tcommutative: true,\n-\t\tgeneric:     true,\n-\t},\n-\t{\n-\t\tname:        \"IsNanFloat32x16\",\n-\t\targLen:      2,\n-\t\tcommutative: true,\n-\t\tgeneric:     true,\n-\t},\n-\t{\n-\t\tname:        \"IsNanFloat64x2\",\n-\t\targLen:      2,\n-\t\tcommutative: true,\n-\t\tgeneric:     true,\n-\t},\n-\t{\n-\t\tname:        \"IsNanFloat64x4\",\n-\t\targLen:      2,\n-\t\tcommutative: true,\n-\t\tgeneric:     true,\n-\t},\n-\t{\n-\t\tname:        \"IsNanFloat64x8\",\n-\t\targLen:      2,\n-\t\tcommutative: true,\n-\t\tgeneric:     true,\n-\t},\n \t{\n \t\tname:    \"LeadingZerosInt32x4\",\n \t\targLen:  1,\ndiff --git a/src/cmd/compile/internal/ssa/rewriteAMD64.go b/src/cmd/compile/internal/ssa/rewriteAMD64.go\nindex 0c044100..0b2bb74c 100644\n--- a/src/cmd/compile/internal/ssa/rewriteAMD64.go\n+++ b/src/cmd/compile/internal/ssa/rewriteAMD64.go\n@@ -3773,18 +3773,18 @@ func rewriteValueAMD64(v *Value) bool {\n \t\treturn true\n \tcase OpIsInBounds:\n \t\treturn rewriteValueAMD64_OpIsInBounds(v)\n-\tcase OpIsNanFloat32x16:\n-\t\treturn rewriteValueAMD64_OpIsNanFloat32x16(v)\n-\tcase OpIsNanFloat32x4:\n-\t\treturn rewriteValueAMD64_OpIsNanFloat32x4(v)\n-\tcase OpIsNanFloat32x8:\n-\t\treturn rewriteValueAMD64_OpIsNanFloat32x8(v)\n-\tcase OpIsNanFloat64x2:\n-\t\treturn rewriteValueAMD64_OpIsNanFloat64x2(v)\n-\tcase OpIsNanFloat64x4:\n-\t\treturn rewriteValueAMD64_OpIsNanFloat64x4(v)\n-\tcase OpIsNanFloat64x8:\n-\t\treturn rewriteValueAMD64_OpIsNanFloat64x8(v)\n+\tcase OpIsNaNFloat32x16:\n+\t\treturn rewriteValueAMD64_OpIsNaNFloat32x16(v)\n+\tcase OpIsNaNFloat32x4:\n+\t\treturn rewriteValueAMD64_OpIsNaNFloat32x4(v)\n+\tcase OpIsNaNFloat32x8:\n+\t\treturn rewriteValueAMD64_OpIsNaNFloat32x8(v)\n+\tcase OpIsNaNFloat64x2:\n+\t\treturn rewriteValueAMD64_OpIsNaNFloat64x2(v)\n+\tcase OpIsNaNFloat64x4:\n+\t\treturn rewriteValueAMD64_OpIsNaNFloat64x4(v)\n+\tcase OpIsNaNFloat64x8:\n+\t\treturn rewriteValueAMD64_OpIsNaNFloat64x8(v)\n \tcase OpIsNonNil:\n \t\treturn rewriteValueAMD64_OpIsNonNil(v)\n \tcase OpIsSliceInBounds:\n@@ -70957,94 +70957,82 @@ func rewriteValueAMD64_OpIsInBounds(v *Value) bool {\n \t\treturn true\n \t}\n }\n-func rewriteValueAMD64_OpIsNanFloat32x16(v *Value) bool {\n-\tv_1 := v.Args[1]\n+func rewriteValueAMD64_OpIsNaNFloat32x16(v *Value) bool {\n \tv_0 := v.Args[0]\n \tb := v.Block\n \ttyp := &b.Func.Config.Types\n-\t// match: (IsNanFloat32x16 x y)\n-\t// result: (VPMOVMToVec32x16 (VCMPPS512 [3] x y))\n+\t// match: (IsNaNFloat32x16 x)\n+\t// result: (VPMOVMToVec32x16 (VCMPPS512 [3] x x))\n \tfor {\n \t\tx := v_0\n-\t\ty := v_1\n \t\tv.reset(OpAMD64VPMOVMToVec32x16)\n \t\tv0 := b.NewValue0(v.Pos, OpAMD64VCMPPS512, typ.Mask)\n \t\tv0.AuxInt = uint8ToAuxInt(3)\n-\t\tv0.AddArg2(x, y)\n+\t\tv0.AddArg2(x, x)\n \t\tv.AddArg(v0)\n \t\treturn true\n \t}\n }\n-func rewriteValueAMD64_OpIsNanFloat32x4(v *Value) bool {\n-\tv_1 := v.Args[1]\n+func rewriteValueAMD64_OpIsNaNFloat32x4(v *Value) bool {\n \tv_0 := v.Args[0]\n-\t// match: (IsNanFloat32x4 x y)\n-\t// result: (VCMPPS128 [3] x y)\n+\t// match: (IsNaNFloat32x4 x)\n+\t// result: (VCMPPS128 [3] x x)\n \tfor {\n \t\tx := v_0\n-\t\ty := v_1\n \t\tv.reset(OpAMD64VCMPPS128)\n \t\tv.AuxInt = uint8ToAuxInt(3)\n-\t\tv.AddArg2(x, y)\n+\t\tv.AddArg2(x, x)\n \t\treturn true\n \t}\n }\n-func rewriteValueAMD64_OpIsNanFloat32x8(v *Value) bool {\n-\tv_1 := v.Args[1]\n+func rewriteValueAMD64_OpIsNaNFloat32x8(v *Value) bool {\n \tv_0 := v.Args[0]\n-\t// match: (IsNanFloat32x8 x y)\n-\t// result: (VCMPPS256 [3] x y)\n+\t// match: (IsNaNFloat32x8 x)\n+\t// result: (VCMPPS256 [3] x x)\n \tfor {\n \t\tx := v_0\n-\t\ty := v_1\n \t\tv.reset(OpAMD64VCMPPS256)\n \t\tv.AuxInt = uint8ToAuxInt(3)\n-\t\tv.AddArg2(x, y)\n+\t\tv.AddArg2(x, x)\n \t\treturn true\n \t}\n }\n-func rewriteValueAMD64_OpIsNanFloat64x2(v *Value) bool {\n-\tv_1 := v.Args[1]\n+func rewriteValueAMD64_OpIsNaNFloat64x2(v *Value) bool {\n \tv_0 := v.Args[0]\n-\t// match: (IsNanFloat64x2 x y)\n-\t// result: (VCMPPD128 [3] x y)\n+\t// match: (IsNaNFloat64x2 x)\n+\t// result: (VCMPPD128 [3] x x)\n \tfor {\n \t\tx := v_0\n-\t\ty := v_1\n \t\tv.reset(OpAMD64VCMPPD128)\n \t\tv.AuxInt = uint8ToAuxInt(3)\n-\t\tv.AddArg2(x, y)\n+\t\tv.AddArg2(x, x)\n \t\treturn true\n \t}\n }\n-func rewriteValueAMD64_OpIsNanFloat64x4(v *Value) bool {\n-\tv_1 := v.Args[1]\n+func rewriteValueAMD64_OpIsNaNFloat64x4(v *Value) bool {\n \tv_0 := v.Args[0]\n-\t// match: (IsNanFloat64x4 x y)\n-\t// result: (VCMPPD256 [3] x y)\n+\t// match: (IsNaNFloat64x4 x)\n+\t// result: (VCMPPD256 [3] x x)\n \tfor {\n \t\tx := v_0\n-\t\ty := v_1\n \t\tv.reset(OpAMD64VCMPPD256)\n \t\tv.AuxInt = uint8ToAuxInt(3)\n-\t\tv.AddArg2(x, y)\n+\t\tv.AddArg2(x, x)\n \t\treturn true\n \t}\n }\n-func rewriteValueAMD64_OpIsNanFloat64x8(v *Value) bool {\n-\tv_1 := v.Args[1]\n+func rewriteValueAMD64_OpIsNaNFloat64x8(v *Value) bool {\n \tv_0 := v.Args[0]\n \tb := v.Block\n \ttyp := &b.Func.Config.Types\n-\t// match: (IsNanFloat64x8 x y)\n-\t// result: (VPMOVMToVec64x8 (VCMPPD512 [3] x y))\n+\t// match: (IsNaNFloat64x8 x)\n+\t// result: (VPMOVMToVec64x8 (VCMPPD512 [3] x x))\n \tfor {\n \t\tx := v_0\n-\t\ty := v_1\n \t\tv.reset(OpAMD64VPMOVMToVec64x8)\n \t\tv0 := b.NewValue0(v.Pos, OpAMD64VCMPPD512, typ.Mask)\n \t\tv0.AuxInt = uint8ToAuxInt(3)\n-\t\tv0.AddArg2(x, y)\n+\t\tv0.AddArg2(x, x)\n \t\tv.AddArg(v0)\n \t\treturn true\n \t}\ndiff --git a/src/cmd/compile/internal/ssagen/intrinsics.go b/src/cmd/compile/internal/ssagen/intrinsics.go\nindex 4425c561..e2eebd78 100644\n--- a/src/cmd/compile/internal/ssagen/intrinsics.go\n+++ b/src/cmd/compile/internal/ssagen/intrinsics.go\n@@ -1667,6 +1667,12 @@ func initIntrinsics(cfg *intrinsicBuildConfig) {\n \t\taddF(simdPackage, \"Uint16x16.IsZero\", opLen1(ssa.OpIsZeroVec, types.Types[types.TBOOL]), sys.AMD64)\n \t\taddF(simdPackage, \"Uint32x8.IsZero\", opLen1(ssa.OpIsZeroVec, types.Types[types.TBOOL]), sys.AMD64)\n \t\taddF(simdPackage, \"Uint64x4.IsZero\", opLen1(ssa.OpIsZeroVec, types.Types[types.TBOOL]), sys.AMD64)\n+\t\taddF(simdPackage, \"Float32x4.IsNaN\", opLen1(ssa.OpIsNaNFloat32x4, types.TypeVec128), sys.AMD64)\n+\t\taddF(simdPackage, \"Float32x8.IsNaN\", opLen1(ssa.OpIsNaNFloat32x8, types.TypeVec256), sys.AMD64)\n+\t\taddF(simdPackage, \"Float32x16.IsNaN\", opLen1(ssa.OpIsNaNFloat32x16, types.TypeVec512), sys.AMD64)\n+\t\taddF(simdPackage, \"Float64x2.IsNaN\", opLen1(ssa.OpIsNaNFloat64x2, types.TypeVec128), sys.AMD64)\n+\t\taddF(simdPackage, \"Float64x4.IsNaN\", opLen1(ssa.OpIsNaNFloat64x4, types.TypeVec256), sys.AMD64)\n+\t\taddF(simdPackage, \"Float64x8.IsNaN\", opLen1(ssa.OpIsNaNFloat64x8, types.TypeVec512), sys.AMD64)\n \n \t\t// sfp4 is intrinsic-if-constant, but otherwise it's complicated enough to just implement in Go.\n \t\tsfp4 := func(method string, hwop ssa.Op, vectype *types.Type) {\ndiff --git a/src/cmd/compile/internal/ssagen/simdintrinsics.go b/src/cmd/compile/internal/ssagen/simdintrinsics.go\nindex 5a957612..4ad0c603 100644\n--- a/src/cmd/compile/internal/ssagen/simdintrinsics.go\n+++ b/src/cmd/compile/internal/ssagen/simdintrinsics.go\n@@ -571,12 +571,6 @@ func simdIntrinsics(addF func(pkg, fn string, b intrinsicBuilder, archFamilies .\n \taddF(simdPackage, \"Uint32x16.InterleaveLoGrouped\", opLen2(ssa.OpInterleaveLoGroupedUint32x16, types.TypeVec512), sys.AMD64)\n \taddF(simdPackage, \"Uint64x4.InterleaveLoGrouped\", opLen2(ssa.OpInterleaveLoGroupedUint64x4, types.TypeVec256), sys.AMD64)\n \taddF(simdPackage, \"Uint64x8.InterleaveLoGrouped\", opLen2(ssa.OpInterleaveLoGroupedUint64x8, types.TypeVec512), sys.AMD64)\n-\taddF(simdPackage, \"Float32x4.IsNan\", opLen2(ssa.OpIsNanFloat32x4, types.TypeVec128), sys.AMD64)\n-\taddF(simdPackage, \"Float32x8.IsNan\", opLen2(ssa.OpIsNanFloat32x8, types.TypeVec256), sys.AMD64)\n-\taddF(simdPackage, \"Float32x16.IsNan\", opLen2(ssa.OpIsNanFloat32x16, types.TypeVec512), sys.AMD64)\n-\taddF(simdPackage, \"Float64x2.IsNan\", opLen2(ssa.OpIsNanFloat64x2, types.TypeVec128), sys.AMD64)\n-\taddF(simdPackage, \"Float64x4.IsNan\", opLen2(ssa.OpIsNanFloat64x4, types.TypeVec256), sys.AMD64)\n-\taddF(simdPackage, \"Float64x8.IsNan\", opLen2(ssa.OpIsNanFloat64x8, types.TypeVec512), sys.AMD64)\n \taddF(simdPackage, \"Int32x4.LeadingZeros\", opLen1(ssa.OpLeadingZerosInt32x4, types.TypeVec128), sys.AMD64)\n \taddF(simdPackage, \"Int32x8.LeadingZeros\", opLen1(ssa.OpLeadingZerosInt32x8, types.TypeVec256), sys.AMD64)\n \taddF(simdPackage, \"Int32x16.LeadingZeros\", opLen1(ssa.OpLeadingZerosInt32x16, types.TypeVec512), sys.AMD64)\ndiff --git a/src/simd/archsimd/_gen/simdgen/ops/Compares/categories.yaml b/src/simd/archsimd/_gen/simdgen/ops/Compares/categories.yaml\nindex eb1d8161..97ee5875 100644\n--- a/src/simd/archsimd/_gen/simdgen/ops/Compares/categories.yaml\n+++ b/src/simd/archsimd/_gen/simdgen/ops/Compares/categories.yaml\n@@ -21,11 +21,6 @@\n   commutative: false\n   documentation: !string |-\n     // NAME returns a mask whose elements indicate whether x <= y.\n-- go: IsNan # For float only.\n-  constImm: 3\n-  commutative: true\n-  documentation: !string |-\n-    // NAME checks if elements are NaN. Use as x.IsNan(x).\n - go: NotEqual\n   constImm: 4\n   commutative: true\ndiff --git a/src/simd/archsimd/_gen/simdgen/ops/Compares/go.yaml b/src/simd/archsimd/_gen/simdgen/ops/Compares/go.yaml\nindex 3f6c8a45..6dbfb573 100644\n--- a/src/simd/archsimd/_gen/simdgen/ops/Compares/go.yaml\n+++ b/src/simd/archsimd/_gen/simdgen/ops/Compares/go.yaml\n@@ -121,7 +121,7 @@\n   - class: mask\n \n # Floats\n-- go: Equal|Greater|Less|LessEqual|GreaterEqual|NotEqual|IsNan\n+- go: (Equal|Greater|Less|LessEqual|GreaterEqual|NotEqual)\n   regexpTag: \"compares\"\n   asm: \"VCMPP[SD]\"\n   in:\n@@ -135,7 +135,7 @@\n   - go: $t\n     overwriteBase: int\n     overwriteClass: mask\n-- go: (Equal|Greater|Less|LessEqual|GreaterEqual|NotEqual|IsNan)\n+- go: (Equal|Greater|Less|LessEqual|GreaterEqual|NotEqual)\n   regexpTag: \"compares\"\n   asm: \"VCMPP[SD]\"\n   in:\ndiff --git a/src/simd/archsimd/extra_amd64.go b/src/simd/archsimd/extra_amd64.go\nindex cd5a3230..b0dba6d2 100644\n--- a/src/simd/archsimd/extra_amd64.go\n+++ b/src/simd/archsimd/extra_amd64.go\n@@ -143,3 +143,39 @@ func (x Uint64x2) IsZero() bool\n //\n // Asm: VPTEST, CPU Feature: AVX\n func (x Uint64x4) IsZero() bool\n+\n+// IsNaN returns a mask whose elements indicate whether the corresponding\n+// elements of x are NaN.\n+//\n+// Asm: VCMPPS, CPU Feature: AVX\n+func (x Float32x4) IsNaN() Mask32x4\n+\n+// IsNaN returns a mask whose elements indicate whether the corresponding\n+// elements of x are NaN.\n+//\n+// Asm: VCMPPS, CPU Feature: AVX\n+func (x Float32x8) IsNaN() Mask32x8\n+\n+// IsNaN returns a mask whose elements indicate whether the corresponding\n+// elements of x are NaN.\n+//\n+// Asm: VCMPPS, CPU Feature: AVX512\n+func (x Float32x16) IsNaN() Mask32x16\n+\n+// IsNaN returns a mask whose elements indicate whether the corresponding\n+// elements of x are NaN.\n+//\n+// Asm: VCMPPD, CPU Feature: AVX\n+func (x Float64x2) IsNaN() Mask64x2\n+\n+// IsNaN returns a mask whose elements indicate whether the corresponding\n+// elements of x are NaN.\n+//\n+// Asm: VCMPPD, CPU Feature: AVX\n+func (x Float64x4) IsNaN() Mask64x4\n+\n+// IsNaN returns a mask whose elements indicate whether the corresponding\n+// elements of x are NaN.\n+//\n+// Asm: VCMPPD, CPU Feature: AVX512\n+func (x Float64x8) IsNaN() Mask64x8\ndiff --git a/src/simd/archsimd/ops_amd64.go b/src/simd/archsimd/ops_amd64.go\nindex 95d417b3..eba340c7 100644\n--- a/src/simd/archsimd/ops_amd64.go\n+++ b/src/simd/archsimd/ops_amd64.go\n@@ -3446,38 +3446,6 @@ func (x Uint64x4) InterleaveLoGrouped(y Uint64x4) Uint64x4\n // Asm: VPUNPCKLQDQ, CPU Feature: AVX512\n func (x Uint64x8) InterleaveLoGrouped(y Uint64x8) Uint64x8\n \n-/* IsNan */\n-\n-// IsNan checks if elements are NaN. Use as x.IsNan(x).\n-//\n-// Asm: VCMPPS, CPU Feature: AVX\n-func (x Float32x4) IsNan(y Float32x4) Mask32x4\n-\n-// IsNan checks if elements are NaN. Use as x.IsNan(x).\n-//\n-// Asm: VCMPPS, CPU Feature: AVX\n-func (x Float32x8) IsNan(y Float32x8) Mask32x8\n-\n-// IsNan checks if elements are NaN. Use as x.IsNan(x).\n-//\n-// Asm: VCMPPS, CPU Feature: AVX512\n-func (x Float32x16) IsNan(y Float32x16) Mask32x16\n-\n-// IsNan checks if elements are NaN. Use as x.IsNan(x).\n-//\n-// Asm: VCMPPD, CPU Feature: AVX\n-func (x Float64x2) IsNan(y Float64x2) Mask64x2\n-\n-// IsNan checks if elements are NaN. Use as x.IsNan(x).\n-//\n-// Asm: VCMPPD, CPU Feature: AVX\n-func (x Float64x4) IsNan(y Float64x4) Mask64x4\n-\n-// IsNan checks if elements are NaN. Use as x.IsNan(x).\n-//\n-// Asm: VCMPPD, CPU Feature: AVX512\n-func (x Float64x8) IsNan(y Float64x8) Mask64x8\n-\n /* LeadingZeros */\n \n // LeadingZeros counts the leading zeros of each element in x.","output":"refactor(simd): change IsNaN from binary to unary operation","metadata":{"id":"go-13440fb5","repository":"go","commit_hash":"13440fb51831bfde5804430596d2045a64fd2209"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" CHANGELOG.md | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a/CHANGELOG.md b/CHANGELOG.md\nindex 3c6ea89..ed950e2 100644\n--- a/CHANGELOG.md\n+++ b/CHANGELOG.md\n@@ -415,7 +415,7 @@\n ### Bug Fixes\n \n * **compile-dom:** should be able to stringify mathML ([#11891](https://github.com/vuejs/core/issues/11891)) ([85c138c](https://github.com/vuejs/core/commit/85c138ced108268f7656b568dfd3036a1e0aae34))\n-* **compiler-sfc:** preserve old behavior when using withDefaults with desutructure ([8492c3c](https://github.com/vuejs/core/commit/8492c3c49a922363d6c77ef192c133a8fbce6514)), closes [#11930](https://github.com/vuejs/core/issues/11930)\n+* **compiler-sfc:** preserve old behavior when using withDefaults with destructure ([8492c3c](https://github.com/vuejs/core/commit/8492c3c49a922363d6c77ef192c133a8fbce6514)), closes [#11930](https://github.com/vuejs/core/issues/11930)\n * **reactivity:** avoid exponential perf cost and reduce call stack depth for deeply chained computeds ([#11944](https://github.com/vuejs/core/issues/11944)) ([c74bb8c](https://github.com/vuejs/core/commit/c74bb8c2dd9e82aaabb0a2a2b368e900929b513b)), closes [#11928](https://github.com/vuejs/core/issues/11928)\n * **reactivity:** rely on dirty check only when computed has deps ([#11931](https://github.com/vuejs/core/issues/11931)) ([aa5dafd](https://github.com/vuejs/core/commit/aa5dafd2b55d42d6a29316a3bc91aea85c676a0b)), closes [#11929](https://github.com/vuejs/core/issues/11929)\n * **watch:** `once` option should be ignored by watchEffect ([#11884](https://github.com/vuejs/core/issues/11884)) ([49fa673](https://github.com/vuejs/core/commit/49fa673493d93b77ddba2165ab6545bae84fd1ae))\n@@ -716,7 +716,7 @@\n \n * **build:** enable SSR branches in esm-browser builds ([b14cd9a](https://github.com/vuejs/core/commit/b14cd9a68bab082332b0169be075be357be076ca))\n * **compiler-core:** change node hoisting to caching per instance ([#11067](https://github.com/vuejs/core/issues/11067)) ([cd0ea0d](https://github.com/vuejs/core/commit/cd0ea0d479a276583fa181d8ecbc97fb0e4a9dce)), closes [#5256](https://github.com/vuejs/core/issues/5256) [#9219](https://github.com/vuejs/core/issues/9219) [#10959](https://github.com/vuejs/core/issues/10959)\n-* **compiler-sfc:** should properly walk desutructured props when reactive destructure is not enabled ([0fd6193](https://github.com/vuejs/core/commit/0fd6193def2380916eb51a118f37f2d9ec2ace23)), closes [#11325](https://github.com/vuejs/core/issues/11325)\n+* **compiler-sfc:** should properly walk destructured props when reactive destructure is not enabled ([0fd6193](https://github.com/vuejs/core/commit/0fd6193def2380916eb51a118f37f2d9ec2ace23)), closes [#11325](https://github.com/vuejs/core/issues/11325)\n * **types:** respect props with default on instance type when using __typeProps ([96e4738](https://github.com/vuejs/core/commit/96e473833422342c5ca371ae1aeb186dec9a55e3))\n \n ","output":"docs: fix typo in changelog","metadata":{"id":"vue-623bfb29","repository":"vue","commit_hash":"623bfb29a23c36bf935e7faefa64d1baa69d465c"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" compiler/rustc_borrowck/src/type_check/mod.rs | 67 ++++-----------------------\n 1 file changed, 9 insertions(+), 58 deletions(-)","output":"refactor(borrowck): simplify type check module","metadata":{"id":"rust-7cab6434","repository":"rust","commit_hash":"7cab6434610cb60a3861b2256d0e2d91b3fddc61"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" docs/en/docs/release-notes.md | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a/docs/en/docs/release-notes.md b/docs/en/docs/release-notes.md\nindex 628eff3..45bc987 100644\n--- a/docs/en/docs/release-notes.md\n+++ b/docs/en/docs/release-notes.md\n@@ -9,6 +9,7 @@ hide:\n \n ### Docs\n \n+* üìù Add contribution instructions about LLM generated code and comments and automated tools for PRs. PR [#14706](https://github.com/fastapi/fastapi/pull/14706) by [@tiangolo](https://github.com/tiangolo).\n * üìù Update docs for management tasks. PR [#14705](https://github.com/fastapi/fastapi/pull/14705) by [@tiangolo](https://github.com/tiangolo).\n * üìù Update docs about managing translations. PR [#14704](https://github.com/fastapi/fastapi/pull/14704) by [@tiangolo](https://github.com/tiangolo).\n * üìù Update docs for contributing with translations. PR [#14701](https://github.com/fastapi/fastapi/pull/14701) by [@tiangolo](https://github.com/tiangolo).","output":"docs: add contribution instructions for LLM generated code","metadata":{"id":"fastapi-a456e92a","repository":"fastapi","commit_hash":"a456e92a21d5b94a67d6d0fd070218df09444443"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" compiler/rustc_resolve/src/diagnostics.rs    | 4 ++--\n compiler/rustc_resolve/src/imports.rs        | 8 ++++----\n tests/ui/hygiene/cross-crate-redefine.rs     | 2 +-\n tests/ui/hygiene/cross-crate-redefine.stderr | 7 +++----\n 4 files changed, 10 insertions(+), 11 deletions(-)\n\ndiff --git a/compiler/rustc_resolve/src/diagnostics.rs b/compiler/rustc_resolve/src/diagnostics.rs\nindex b80011e8c0c..9f13ba1201f 100644\n--- a/compiler/rustc_resolve/src/diagnostics.rs\n+++ b/compiler/rustc_resolve/src/diagnostics.rs\n@@ -212,12 +212,12 @@ pub(crate) fn report_conflict(\n         &mut self,\n         ident: Ident,\n         ns: Namespace,\n-        new_binding: Decl<'ra>,\n         old_binding: Decl<'ra>,\n+        new_binding: Decl<'ra>,\n     ) {\n         // Error on the second of two conflicting names\n         if old_binding.span.lo() > new_binding.span.lo() {\n-            return self.report_conflict(ident, ns, old_binding, new_binding);\n+            return self.report_conflict(ident, ns, new_binding, old_binding);\n         }\n \n         let container = match old_binding.parent_module.unwrap().kind {\ndiff --git a/compiler/rustc_resolve/src/imports.rs b/compiler/rustc_resolve/src/imports.rs\nindex 7c0cbcf1d52..c3ea408deb8 100644\n--- a/compiler/rustc_resolve/src/imports.rs\n+++ b/compiler/rustc_resolve/src/imports.rs\n@@ -348,8 +348,8 @@ pub(crate) fn new_import_decl(&self, decl: Decl<'ra>, import: Import<'ra>) -> De\n     /// decide which one to keep.\n     fn select_glob_decl(\n         &self,\n-        glob_decl: Decl<'ra>,\n         old_glob_decl: Decl<'ra>,\n+        glob_decl: Decl<'ra>,\n         warn_ambiguity: bool,\n     ) -> Decl<'ra> {\n         assert!(glob_decl.is_glob_import());\n@@ -369,7 +369,7 @@ fn select_glob_decl(\n         // with the re-fetched decls.\n         // This is probably incorrect in corner cases, and the outdated decls still get\n         // propagated to other places and get stuck there, but that's what we have at the moment.\n-        let (deep_decl, old_deep_decl) = remove_same_import(glob_decl, old_glob_decl);\n+        let (old_deep_decl, deep_decl) = remove_same_import(old_glob_decl, glob_decl);\n         if deep_decl != glob_decl {\n             // Some import layers have been removed, need to overwrite.\n             assert_ne!(old_deep_decl, old_glob_decl);\n@@ -436,7 +436,7 @@ pub(crate) fn try_plant_decl_into_local_module(\n                 match (old_decl.is_glob_import(), decl.is_glob_import()) {\n                     (true, true) => {\n                         resolution.glob_decl =\n-                            Some(this.select_glob_decl(decl, old_decl, warn_ambiguity));\n+                            Some(this.select_glob_decl(old_decl, decl, warn_ambiguity));\n                     }\n                     (old_glob @ true, false) | (old_glob @ false, true) => {\n                         let (glob_decl, non_glob_decl) =\n@@ -446,7 +446,7 @@ pub(crate) fn try_plant_decl_into_local_module(\n                             && old_glob_decl != glob_decl\n                         {\n                             resolution.glob_decl =\n-                                Some(this.select_glob_decl(glob_decl, old_glob_decl, false));\n+                                Some(this.select_glob_decl(old_glob_decl, glob_decl, false));\n                         } else {\n                             resolution.glob_decl = Some(glob_decl);\n                         }\ndiff --git a/tests/ui/hygiene/cross-crate-redefine.rs b/tests/ui/hygiene/cross-crate-redefine.rs\nindex e42c5e3de06..a87c933391d 100644\n--- a/tests/ui/hygiene/cross-crate-redefine.rs\n+++ b/tests/ui/hygiene/cross-crate-redefine.rs\n@@ -8,7 +8,7 @@\n use use_by_macro::*;\n \n my_struct!(define);\n-//~^ ERROR the name `MyStruct` is defined multiple times\n my_struct!(define);\n+//~^ ERROR the name `MyStruct` is defined multiple times\n \n fn main() {}\ndiff --git a/tests/ui/hygiene/cross-crate-redefine.stderr b/tests/ui/hygiene/cross-crate-redefine.stderr\nindex c0fd3f4b7eb..8ad7d6d7b08 100644\n--- a/tests/ui/hygiene/cross-crate-redefine.stderr\n+++ b/tests/ui/hygiene/cross-crate-redefine.stderr\n@@ -1,11 +1,10 @@\n error[E0428]: the name `MyStruct` is defined multiple times\n-  --> $DIR/cross-crate-redefine.rs:10:1\n+  --> $DIR/cross-crate-redefine.rs:11:1\n    |\n-LL | my_struct!(define);\n-   | ^^^^^^^^^^^^^^^^^^ `MyStruct` redefined here\n-LL |\n LL | my_struct!(define);\n    | ------------------ previous definition of the type `MyStruct` here\n+LL | my_struct!(define);\n+   | ^^^^^^^^^^^^^^^^^^ `MyStruct` redefined here\n    |\n    = note: `MyStruct` must be defined only once in the type namespace of this module\n    = note: this error originates in the macro `my_struct` (in Nightly builds, run with -Z macro-backtrace for more info)","output":"refactor(resolve): reorder parameters for consistent old/new ordering","metadata":{"id":"rust-81ef42d5","repository":"rust","commit_hash":"81ef42d5b7c4de7e8fa621fff4dc8f4627a581dc"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" docs/en/docs/release-notes.md | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a/docs/en/docs/release-notes.md b/docs/en/docs/release-notes.md\nindex 5bd1b03..19efeec 100644\n--- a/docs/en/docs/release-notes.md\n+++ b/docs/en/docs/release-notes.md\n@@ -13,6 +13,7 @@ hide:\n \n ### Translations\n \n+* üåê Update translations for ko (update-outdated). PR [#14589](https://github.com/fastapi/fastapi/pull/14589) by [@tiangolo](https://github.com/tiangolo).\n * üåê Update translations for uk (update-outdated). PR [#14587](https://github.com/fastapi/fastapi/pull/14587) by [@tiangolo](https://github.com/tiangolo).\n * üåê Update translations for es (update-outdated). PR [#14686](https://github.com/fastapi/fastapi/pull/14686) by [@tiangolo](https://github.com/tiangolo).\n * üîß Add LLM prompt file for Turkish, generated from the existing translations. PR [#14547](https://github.com/fastapi/fastapi/pull/14547) by [@tiangolo](https://github.com/tiangolo).","output":"docs: update korean translation release notes","metadata":{"id":"fastapi-16e58341","repository":"fastapi","commit_hash":"16e583413c678f36e3f2204675c384bc884ecbd1"}}
{"instruction":"Generate a conventional commit message for the following git diff.\n\nFollow the conventional commit format: type(scope): description\n\nTypes: feat, fix, docs, style, refactor, test, chore, ci, build, perf\n\nRules:\n- Use lowercase for description\n- Use imperative mood (add, fix, update)\n- No period at end\n- Keep under 72 characters","input":" .mailmap                                           |   1 +\n INSTALL.md                                         |   2 +-\n compiler/rustc_attr_parsing/src/attributes/cfg.rs  |   1 -\n compiler/rustc_attr_parsing/src/attributes/doc.rs  |   6 -\n compiler/rustc_attr_parsing/src/parser.rs          |   8 +-\n compiler/rustc_borrowck/src/type_check/mod.rs      |  67 +--\n compiler/rustc_builtin_macros/messages.ftl         |   2 +\n compiler/rustc_builtin_macros/src/eii.rs           |  94 ++--\n compiler/rustc_builtin_macros/src/errors.rs        |  10 +\n compiler/rustc_codegen_llvm/src/mono_item.rs       |   2 +-\n compiler/rustc_codegen_llvm/src/va_arg.rs          |   9 -\n compiler/rustc_hir_analysis/src/collect.rs         |   8 +-\n .../src/errors/wrong_number_of_generic_args.rs     |   3 +\n .../src/hir_ty_lowering/bounds.rs                  |  35 +-\n .../rustc_hir_analysis/src/hir_ty_lowering/mod.rs  | 136 +++--\n compiler/rustc_hir_analysis/src/lib.rs             |   6 +-\n compiler/rustc_hir_typeck/src/expr.rs              |   4 +-\n compiler/rustc_hir_typeck/src/fn_ctxt/_impl.rs     |  13 +-\n compiler/rustc_hir_typeck/src/method/confirm.rs    |   7 +-\n compiler/rustc_parse/src/parser/generics.rs        |  26 +-\n compiler/rustc_parse/src/parser/item.rs            |   1 +\n compiler/rustc_resolve/src/diagnostics.rs          |   4 +-\n compiler/rustc_resolve/src/imports.rs              |  23 +-\n compiler/rustc_span/src/symbol.rs                  |   1 -\n compiler/rustc_target/src/asm/mod.rs               |   2 +-\n compiler/rustc_target/src/callconv/mod.rs          |   2 +-\n compiler/rustc_target/src/spec/mod.rs              |   7 +-\n compiler/rustc_target/src/target_features.rs       |   8 +-\n library/std/src/sys/thread/unix.rs                 |   9 +\n src/bootstrap/Cargo.toml                           |   2 +-\n src/build_helper/Cargo.toml                        |   7 +-\n src/build_helper/src/lib.rs                        |   1 +\n src/ci/citool/Cargo.toml                           |   2 +-\n src/librustdoc/clean/mod.rs                        |  50 +-\n src/librustdoc/passes/collect_intra_doc_links.rs   | 624 +++++++++++----------\n src/tools/miri/src/shims/alloc.rs                  |   1 -\n src/tools/opt-dist/Cargo.toml                      |   2 +-\n tests/rustdoc-html/intra-doc/adt-through-alias.rs  |  71 +++\n tests/rustdoc-html/intra-doc/associated-items.rs   |   9 +-\n .../associated-const-bindings/ambiguity.stderr     |   6 +\n tests/ui/const-generics/incorrect-const-param.rs   |  45 ++\n .../ui/const-generics/incorrect-const-param.stderr |  70 +++\n .../mgca/tuple_expr_arg_bad-issue-151048.rs        |   8 +\n .../mgca/tuple_expr_arg_bad-issue-151048.stderr    |   8 +\n tests/ui/eii/error_statement_position.rs           |  15 +-\n tests/ui/eii/error_statement_position.stderr       |  13 +-\n tests/ui/generics/wrong-number-of-args-in-macro.rs |  15 +\n .../generics/wrong-number-of-args-in-macro.stderr  |  44 ++\n tests/ui/hygiene/cross-crate-redefine.rs           |   2 +-\n tests/ui/hygiene/cross-crate-redefine.stderr       |   7 +-\n tests/ui/imports/overwrite-deep-glob.rs            |  22 +\n tests/ui/imports/overwrite-deep-glob.stderr        |  12 +\n tests/ui/imports/overwrite-different-ambig-2.rs    |  24 +\n .../ui/imports/overwrite-different-ambig-2.stderr  |  49 ++\n tests/ui/imports/overwrite-different-ambig.rs      |  25 +\n tests/ui/imports/overwrite-different-vis.rs        |  21 +\n .../imports/overwrite-different-warn-ambiguity.rs  |  28 +\n .../macro/kw-in-const-item-pos-recovery-149692.rs  |  11 +\n .../kw-in-const-item-pos-recovery-149692.stderr    |  11 +\n .../parser/macro/kw-in-item-pos-recovery-149692.rs |  19 +\n .../macro/kw-in-item-pos-recovery-149692.stderr    |  29 +\n 61 files changed, 1140 insertions(+), 610 deletions(-)","output":"refactor: update compiler internals and improve intra-doc links","metadata":{"id":"rust-b6fdaf2a","repository":"rust","commit_hash":"b6fdaf2a15736cbccf248b532f48e33179614d40"}}
